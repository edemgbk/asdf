!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@aws-amplify/core"),require("@aws-amplify/cache")):"function"==typeof define&&define.amd?define("aws_amplify_analytics",["@aws-amplify/core","@aws-amplify/cache"],t):"object"==typeof exports?exports.aws_amplify_analytics=t(require("@aws-amplify/core"),require("@aws-amplify/cache")):e.aws_amplify_analytics=t(e["@aws-amplify/core"],e["@aws-amplify/cache"])}(this,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=216)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return s})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return d})),n.d(t,"__generator",(function(){return l})),n.d(t,"__createBinding",(function(){return f})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return h})),n.d(t,"__read",(function(){return v})),n.d(t,"__spread",(function(){return _})),n.d(t,"__spreadArrays",(function(){return g})),n.d(t,"__await",(function(){return y})),n.d(t,"__asyncGenerator",(function(){return m})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return w})),n.d(t,"__makeTemplateObject",(function(){return O})),n.d(t,"__importStar",(function(){return E})),n.d(t,"__importDefault",(function(){return S})),n.d(t,"__classPrivateFieldGet",(function(){return j})),n.d(t,"__classPrivateFieldSet",(function(){return A}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function f(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}function p(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(u,c):d(o[0][2],n)}catch(e){d(o[0][3],e)}var n}function u(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function j(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function A(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(89),t),r.__exportStar(n(91),t),r.__exportStar(n(92),t),r.__exportStar(n(93),t),r.__exportStar(n(94),t),r.__exportStar(n(95),t),r.__exportStar(n(96),t),r.__exportStar(n(97),t),r.__exportStar(n(98),t),r.__exportStar(n(99),t),r.__exportStar(n(100),t),r.__exportStar(n(101),t),r.__exportStar(n(102),t),r.__exportStar(n(103),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(104),t),r.__exportStar(n(105),t),r.__exportStar(n(106),t),r.__exportStar(n(107),t)},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0;var r=n(132),i=n(133);t.fromUtf8=function(e){return"function"==typeof TextEncoder?i.fromUtf8(e):r.fromUtf8(e)},t.toUtf8=function(e){return"function"==typeof TextDecoder?i.toUtf8(e):r.toUtf8(e)}},function(e,t,n){var r=n(72),i=n(74),o=n(75),s=n(23),a=n(76),u=n(40),c=n(73),d=n(41),l=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||d(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(l.call(e,n))return!1;return!0}},function(e,t,n){var r=n(86),i=n(87),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toBase64=t.fromBase64=void 0;for(var r={},i=new Array(64),o=0,s="A".charCodeAt(0),a="Z".charCodeAt(0);o+s<=a;o++){var u=String.fromCharCode(o+s);r[u]=o,i[o]=u}for(o=0,s="a".charCodeAt(0),a="z".charCodeAt(0);o+s<=a;o++){u=String.fromCharCode(o+s);var c=o+26;r[u]=c,i[c]=u}for(o=0;o<10;o++){r[o.toString(10)]=o+52;u=o.toString(10),c=o+52;r[u]=c,i[c]=u}r["+"]=62,i[62]="+",r["/"]=63,i[63]="/";t.fromBase64=function(e){var t=e.length/4*3;"=="===e.substr(-2)?t-=2:"="===e.substr(-1)&&t--;for(var n=new ArrayBuffer(t),i=new DataView(n),o=0;o<e.length;o+=4){for(var s=0,a=0,u=o,c=o+3;u<=c;u++)"="!==e[u]?(s|=r[e[u]]<<6*(c-u),a+=6):s>>=6;var d=o/4*3;s>>=a%8;for(var l=Math.floor(a/8),f=0;f<l;f++){var p=8*(l-f-1);i.setUint8(d+f,(s&255<<p)>>p)}}return new Uint8Array(n)},t.toBase64=function(e){for(var t="",n=0;n<e.length;n+=3){for(var r=0,o=0,s=n,a=Math.min(n+3,e.length);s<a;s++)r|=e[s]<<8*(a-s-1),o+=8;var u=Math.ceil(o/6);r<<=6*u-o;for(var c=1;c<=u;c++){var d=6*(u-c);t+=i[(r&63<<d)>>d]}t+="==".slice(0,4-u)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(48),t),r.__exportStar(n(49),t),r.__exportStar(n(88),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(108),t),r.__exportStar(n(109),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHostHeaderPlugin=t.hostHeaderMiddlewareOptions=t.hostHeaderMiddleware=t.resolveHostHeaderConfig=void 0;var r=n(0),i=n(2);t.resolveHostHeaderConfig=function(e){return e},t.hostHeaderMiddleware=function(e){return function(t){return function(n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(r){return i.HttpRequest.isInstance(n.request)?(o=n.request,s=(e.requestHandler.metadata||{}).handlerProtocol,(void 0===s?"":s).indexOf("h2")>=0&&!o.headers[":authority"]?(delete o.headers.host,o.headers[":authority"]=""):o.headers.host||(o.headers.host=o.hostname),[2,t(n)]):[2,t(n)]}))}))}}},t.hostHeaderMiddlewareOptions={name:"hostHeaderMiddleware",step:"build",tags:["HOST"]},t.getHostHeaderPlugin=function(e){return{applyToStack:function(n){n.add(t.hostHeaderMiddleware(e),t.hostHeaderMiddlewareOptions)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(110),t),r.__exportStar(n(51),t),r.__exportStar(n(113),t),r.__exportStar(n(53),t),r.__exportStar(n(54),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(114),t),r.__exportStar(n(116),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(117),t),r.__exportStar(n(118),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(127),t),r.__exportStar(n(130),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invalidFunction=void 0,t.invalidFunction=function(e){return function(){throw new Error(e)}}},function(e,t,n){var r=n(67),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHex=t.fromHex=void 0;for(var r={},i={},o=0;o<256;o++){var s=o.toString(16).toLowerCase();1===s.length&&(s="0"+s),r[o]=s,i[s]=o}t.fromHex=function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2){var r=e.substr(n,2).toLowerCase();if(!(r in i))throw new Error("Cannot decode unrecognized sequence "+r+" as hexadecimal");t[n/2]=i[r]}return t},t.toHex=function(e){for(var t="",n=0;n<e.byteLength;n++)t+=r[e[n]];return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContentLengthPlugin=t.contentLengthMiddlewareOptions=t.contentLengthMiddleware=void 0;var r=n(0),i=n(2);function o(e){var t=this;return function(n){return function(o){return r.__awaiter(t,void 0,void 0,(function(){var t,s,a,u,c;return r.__generator(this,(function(d){return t=o.request,i.HttpRequest.isInstance(t)&&(s=t.body,a=t.headers,s&&-1===Object.keys(a).map((function(e){return e.toLowerCase()})).indexOf("content-length")&&void 0!==(u=e(s))&&(t.headers=r.__assign(r.__assign({},t.headers),((c={})["content-length"]=String(u),c)))),[2,n(r.__assign(r.__assign({},o),{request:t}))]}))}))}}}t.contentLengthMiddleware=o,t.contentLengthMiddlewareOptions={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware"},t.getContentLengthPlugin=function(e){return{applyToStack:function(n){n.add(o(e.bodyLengthChecker),t.contentLengthMiddlewareOptions)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(119),t);var r=n(56);t.Ie11Sha256=r.Sha256;var i=n(59);t.WebCryptoSha256=i.Sha256},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUrl=void 0;var r=n(131);t.parseUrl=function(e){var t,n=new URL(e),i=n.hostname,o=n.pathname,s=n.port,a=n.protocol,u=n.search;return u&&(t=r.parseQueryString(u)),{hostname:i,port:s?parseInt(s):void 0,protocol:a,path:o,query:t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateBodyLength=void 0,t.calculateBodyLength=function(e){return"string"==typeof e?new Blob([e]).size:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultUserAgent=void 0,t.defaultUserAgent=function(e,t){return"aws-sdk-js-v3-"+e+"/"+t+" "+("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(155),i=n(158);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(55),t),r.__exportStar(n(115),t)},function(e,t,n){var r=n(29),i=n(147),o=n(148),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(16).Symbol;e.exports=r},function(e,t,n){var r=n(24)(Object,"create");e.exports=r},function(e,t,n){var r=n(163),i=n(164),o=n(165),s=n(166),a=n(167);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(71);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(169);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(188);e.exports=function(e,t){return r(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NO_RETRY_INCREMENT=t.TIMEOUT_RETRY_COST=t.RETRY_COST=t.INITIAL_RETRY_TOKENS=t.THROTTLING_RETRY_DELAY_BASE=t.MAXIMUM_RETRY_DELAY=t.DEFAULT_RETRY_DELAY_BASE=void 0,t.DEFAULT_RETRY_DELAY_BASE=100,t.MAXIMUM_RETRY_DELAY=2e4,t.THROTTLING_RETRY_DELAY_BASE=500,t.INITIAL_RETRY_TOKENS=500,t.RETRY_COST=5,t.TIMEOUT_RETRY_COST=10,t.NO_RETRY_INCREMENT=1},function(e,t,n){"use strict";n.r(t),n.d(t,"locateWindow",(function(){return i}));var r={};function i(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:r}},function(e,t,n){var r=n(27),i=n(28);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(152),i=n(168),o=n(170),s=n(171),a=n(172);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(24)(n(16),"Map");e.exports=r},function(e,t,n){(function(e){var r=n(16),i=n(184),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||i;e.exports=u}).call(this,n(78)(e))},function(e,t,n){var r=n(185),i=n(186),o=n(187),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},function(e){e.exports=JSON.parse('{"a":"@aws-sdk/client-pinpoint","b":"1.0.0-gamma.4"}')},function(e){e.exports=JSON.parse('{"a":"@aws-sdk/client-kinesis","b":"1.0.0-gamma.4"}')},function(e){e.exports=JSON.parse('{"a":"@aws-sdk/client-firehose","b":"1.0.0-gamma.4"}')},function(e){e.exports=JSON.parse('{"a":"@aws-sdk/client-personalize-events","b":"1.0.0-gamma.4"}')},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserializerMiddleware=void 0;var r=n(0);t.deserializerMiddleware=function(e,t){var n=this;return function(i){return function(o){return r.__awaiter(n,void 0,void 0,(function(){var n,s;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i(o)];case 1:return n=r.sent().response,[4,t(n,e)];case 2:return s=r.sent(),[2,{response:n,output:s}]}}))}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializerMiddleware=void 0;var r=n(0);t.serializerMiddleware=function(e,t){var n=this;return function(i){return function(o){return r.__awaiter(n,void 0,void 0,(function(){var n;return r.__generator(this,(function(s){switch(s.label){case 0:return[4,t(o.input,e)];case 1:return n=s.sent(),[2,i(r.__assign(r.__assign({},o),{request:n}))]}}))}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(90),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardRetryStrategy=t.DEFAULT_RETRY_MODE=t.DEFAULT_MAX_ATTEMPTS=void 0;var r=n(0),i=n(2),o=n(52),s=n(6),a=n(35),u=n(112),c=n(53),d=n(54);t.DEFAULT_MAX_ATTEMPTS="3",t.DEFAULT_RETRY_MODE="standard";var l=function(){function e(e,t){var n,r,i;this.maxAttemptsProvider=e,this.retryDecider=null!==(n=null==t?void 0:t.retryDecider)&&void 0!==n?n:d.defaultRetryDecider,this.delayDecider=null!==(r=null==t?void 0:t.delayDecider)&&void 0!==r?r:c.defaultDelayDecider,this.retryQuota=null!==(i=null==t?void 0:t.retryQuota)&&void 0!==i?i:u.getDefaultRetryQuota(a.INITIAL_RETRY_TOKENS)}return e.prototype.shouldRetry=function(e,t,n){return t<n&&this.retryDecider(e)&&this.retryQuota.hasRetryTokens(e)},e.prototype.getMaxAttempts=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.maxAttemptsProvider()];case 1:return e=r.sent(),[3,3];case 2:return r.sent(),e=t.DEFAULT_MAX_ATTEMPTS,[3,3];case 3:return n=parseInt(e),[2,Number.isNaN(n)?parseInt(t.DEFAULT_MAX_ATTEMPTS):n]}}))}))},e.prototype.retry=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,u,c,d,l,f,p,h;return r.__generator(this,(function(v){switch(v.label){case 0:return u=0,c=0,[4,this.getMaxAttempts()];case 1:d=v.sent(),l=t.request,i.HttpRequest.isInstance(l)&&(l.headers["amz-sdk-invocation-id"]=s.v4()),f=function(){var s,f,h,v,_;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,5]),i.HttpRequest.isInstance(l)&&(l.headers["amz-sdk-request"]="attempt="+(u+1)+"; max="+d),[4,e(t)];case 1:return s=r.sent(),f=s.response,h=s.output,p.retryQuota.releaseRetryTokens(n),h.$metadata.attempts=u+1,h.$metadata.totalRetryDelay=c,[2,{value:{response:f,output:h}}];case 2:return v=r.sent(),u++,p.shouldRetry(v,u,d)?(n=p.retryQuota.retrieveRetryTokens(v),_=p.delayDecider(o.isThrottlingError(v)?a.THROTTLING_RETRY_DELAY_BASE:a.DEFAULT_RETRY_DELAY_BASE,u),c+=_,[4,new Promise((function(e){return setTimeout(e,_)}))]):[3,4];case 3:return r.sent(),[2,"continue"];case 4:throw v.$metadata||(v.$metadata={}),v.$metadata.attempts=u,v.$metadata.totalRetryDelay=c,v;case 5:return[2]}}))},p=this,v.label=2;case 2:return[5,f()];case 3:return"object"==typeof(h=v.sent())?[2,h.value]:[3,2];case 4:return[2]}}))}))},e}();t.StandardRetryStrategy=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransientError=t.isThrottlingError=t.isClockSkewError=t.isRetryableByTrait=void 0;var r=n(111);t.isRetryableByTrait=function(e){return void 0!==e.$retryable},t.isClockSkewError=function(e){return r.CLOCK_SKEW_ERROR_CODES.includes(e.name)},t.isThrottlingError=function(e){var t;return r.THROTTLING_ERROR_CODES.includes(e.name)||1==(null===(t=e.$retryable)||void 0===t?void 0:t.throttling)},t.isTransientError=function(e){var t;return r.TRANSIENT_ERROR_CODES.includes(e.name)||r.TRANSIENT_ERROR_STATUS_CODES.includes((null===(t=e.$metadata)||void 0===t?void 0:t.httpStatusCode)||0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultDelayDecider=void 0;var r=n(35);t.defaultDelayDecider=function(e,t){return Math.floor(Math.min(r.MAXIMUM_RETRY_DELAY,Math.random()*Math.pow(2,t)*e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultRetryDecider=void 0;var r=n(52);t.defaultRetryDecider=function(e){return!!e&&(r.isRetryableByTrait(e)||r.isClockSkewError(e)||r.isThrottlingError(e)||r.isTransientError(e))}},function(e,t,n){"use strict";function r(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.escapeUri=void 0,t.escapeUri=function(e){var t=encodeURIComponent(e);return t=t.replace(/[!'()*]/g,r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),i=n(58),o=n(80),s=n(36),a=function(){function e(e){e?(this.operation=function(e){return new Promise((function(t,n){var r=s.locateWindow().msCrypto.subtle.importKey("raw",u(e),i.SHA_256_HMAC_ALGO,!1,["sign"]);r.oncomplete=function(){r.result&&t(r.result),n("ImportKey completed without importing key.")},r.onerror=function(){n("ImportKey failed to import key.")}}))}(e).then((function(e){return s.locateWindow().msCrypto.subtle.sign(i.SHA_256_HMAC_ALGO,e)})),this.operation.catch((function(){}))):this.operation=Promise.resolve(s.locateWindow().msCrypto.subtle.digest("SHA-256"))}return e.prototype.update=function(e){var t=this;r.isEmptyData(e)||(this.operation=this.operation.then((function(n){return n.onerror=function(){t.operation=Promise.reject(new Error("Error encountered updating hash"))},n.process(u(e)),n})),this.operation.catch((function(){})))},e.prototype.digest=function(){return this.operation.then((function(e){return new Promise((function(t,n){e.onerror=function(){n("Error encountered finalizing hash")},e.oncomplete=function(){e.result&&t(new Uint8Array(e.result)),n("Error encountered finalizing hash")},e.finish()}))}))},e}();function u(e){return"string"==typeof e?o.fromUtf8(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.Sha256=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=function(e){return"string"==typeof e?0===e.length:0===e.byteLength}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHA_256_HASH={name:"SHA-256"},t.SHA_256_HMAC_ALGO={name:"HMAC",hash:t.SHA_256_HASH},t.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),i=n(57),o=n(58),s=n(36),a=function(){function e(e){this.toHash=new Uint8Array(0),void 0!==e&&(this.key=new Promise((function(t,n){s.locateWindow().crypto.subtle.importKey("raw",u(e),o.SHA_256_HMAC_ALGO,!1,["sign"]).then(t,n)})),this.key.catch((function(){})))}return e.prototype.update=function(e){if(!i.isEmptyData(e)){var t=u(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},e.prototype.digest=function(){var e=this;return this.key?this.key.then((function(t){return s.locateWindow().crypto.subtle.sign(o.SHA_256_HMAC_ALGO,t,e.toHash).then((function(e){return new Uint8Array(e)}))})):i.isEmptyData(this.toHash)?Promise.resolve(o.EMPTY_DATA_SHA_256):Promise.resolve().then((function(){return s.locateWindow().crypto.subtle.digest(o.SHA_256_HASH,e.toHash)})).then((function(e){return Promise.resolve(new Uint8Array(e))}))},e}();function u(e){return"string"==typeof e?r.fromUtf8(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.Sha256=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventStreamMarshaller=void 0;var r=n(62),i=n(139),o=n(66),s=function(){function e(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new r.EventStreamMarshaller(t,n),this.universalMarshaller=new i.EventStreamMarshaller({utf8Decoder:n,utf8Encoder:t})}return e.prototype.deserialize=function(e,t){var n=a(e)?o.readableStreamtoIterable(e):e;return this.universalMarshaller.deserialize(n,t)},e.prototype.serialize=function(e,t){var n=this.universalMarshaller.serialize(e,t);return"function"==typeof ReadableStream?o.iterableToReadableStream(n):n},e}();t.EventStreamMarshaller=s;var a=function(e){return"function"==typeof ReadableStream&&e instanceof ReadableStream}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(135),t),r.__exportStar(n(64),t),r.__exportStar(n(138),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.crc32=function(e){return(new i).update(e).digest()};var i=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var i=r.__values(e),s=i.next();!s.done;s=i.next()){var a=s.value;this.checksum=this.checksum>>>8^o[255&(this.checksum^a)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=i;var o=Uint32Array.from([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Int64=void 0;var r=n(17),i=function(){function e(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}return e.fromNumber=function(t){if(t>0x8000000000000000||t<-0x8000000000000000)throw new Error(t+" is too large (or, if negative, too small) to represent as an Int64");for(var n=new Uint8Array(8),r=7,i=Math.abs(Math.round(t));r>-1&&i>0;r--,i/=256)n[r]=i;return t<0&&o(n),new e(n)},e.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&o(e),parseInt(r.toHex(e),16)*(t?-1:1)},e.prototype.toString=function(){return String(this.valueOf())},e}();function o(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&(e[t]++,0===e[t]);t--);}t.Int64=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventStreamMarshaller=void 0;var r=n(0),i=n(62),o=n(141),s=n(142),a=function(){function e(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new i.EventStreamMarshaller(t,n),this.utfEncoder=t}return e.prototype.deserialize=function(e,t){var n=o.getChunkedStream(e);return s.getUnmarshalledStream(n,{eventMarshaller:this.eventMarshaller,deserializer:t,toUtf8:this.utfEncoder})},e.prototype.serialize=function(e,t){var n,i=this;return(n={})[Symbol.asyncIterator]=function(){return r.__asyncGenerator(this,arguments,(function(){var n,o,s,a,u,c,d;return r.__generator(this,(function(l){switch(l.label){case 0:l.trys.push([0,7,8,13]),n=r.__asyncValues(e),l.label=1;case 1:return[4,r.__await(n.next())];case 2:return(o=l.sent()).done?[3,6]:(s=o.value,a=i.eventMarshaller.marshall(t(s)),[4,r.__await(a)]);case 3:return[4,l.sent()];case 4:l.sent(),l.label=5;case 5:return[3,1];case 6:return[3,13];case 7:return u=l.sent(),c={error:u},[3,13];case 8:return l.trys.push([8,,11,12]),o&&!o.done&&(d=n.return)?[4,r.__await(d.call(n))]:[3,10];case 9:l.sent(),l.label=10;case 10:return[3,12];case 11:if(c)throw c.error;return[7];case 12:return[7];case 13:return[4,r.__await(new Uint8Array(0))];case 14:return[4,l.sent()];case 15:return l.sent(),[2]}}))}))},n},e}();t.EventStreamMarshaller=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterableToReadableStream=t.readableStreamtoIterable=void 0;var r=n(0);t.readableStreamtoIterable=function(e){var t;return(t={})[Symbol.asyncIterator]=function(){return r.__asyncGenerator(this,arguments,(function(){var t,n,i,o;return r.__generator(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,r.__await(t.read())];case 3:return n=s.sent(),i=n.done,o=n.value,i?[4,r.__await(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,r.__await(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))},t},t.iterableToReadableStream=function(e){var t=e[Symbol.asyncIterator]();return new ReadableStream({pull:function(e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,t.next()];case 1:return n=r.sent(),i=n.done,o=n.value,i?[2,e.close()]:(e.enqueue(o),[2])}}))}))}})}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(146))},function(e,t,n){var r=n(27),i=n(69);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(73),i=n(177),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(179),i=n(39),o=n(180),s=n(181),a=n(182),u=n(27),c=n(70),d=c(r),l=c(i),f=c(o),p=c(s),h=c(a),v=u;(r&&"[object DataView]"!=v(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=v(new i)||o&&"[object Promise]"!=v(o.resolve())||s&&"[object Set]"!=v(new s)||a&&"[object WeakMap]"!=v(new a))&&(v=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case d:return"[object DataView]";case l:return"[object Map]";case f:return"[object Promise]";case p:return"[object Set]";case h:return"[object WeakMap]"}return t}),e.exports=v},function(e,t,n){var r=n(183),i=n(28),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},function(e,t,n){var r=n(68),i=n(77);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(196),i=n(199),o=n(200);e.exports=function(e,t,n,s,a,u){var c=1&n,d=e.length,l=t.length;if(d!=l&&!(c&&l>d))return!1;var f=u.get(e),p=u.get(t);if(f&&p)return f==t&&p==e;var h=-1,v=!0,_=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++h<d;){var g=e[h],y=t[h];if(s)var m=c?s(y,g,h,t,e,u):s(g,y,h,e,t,u);if(void 0!==m){if(m)continue;v=!1;break}if(_){if(!i(t,(function(e,t){if(!o(_,t)&&(g===e||a(g,e,n,s,u)))return _.push(t)}))){v=!1;break}}else if(g!==y&&!a(g,y,n,s,u)){v=!1;break}}return u.delete(e),u.delete(t),v}},function(e,t,n){"use strict";function r(e){return"function"==typeof TextEncoder?function(e){return(new TextEncoder).encode(e)}(e):function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192,63&i|128);else if(n+1<e.length&&55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))){var o=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n));t.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}else t.push(i>>12|224,i>>6&63|128,63&i|128)}return Uint8Array.from(t)}(e)}function i(e){return"function"==typeof TextDecoder?function(e){return new TextDecoder("utf-8").decode(e)}(e):function(e){for(var t="",n=0,r=e.length;n<r;n++){var i=e[n];if(i<128)t+=String.fromCharCode(i);else if(192<=i&&i<224){var o=e[++n];t+=String.fromCharCode((31&i)<<6|63&o)}else if(240<=i&&i<365){var s="%"+[i,e[++n],e[++n],e[++n]].map((function(e){return e.toString(16)})).join("%");t+=decodeURIComponent(s)}else t+=String.fromCharCode((15&i)<<12|(63&e[++n])<<6|63&e[++n])}return t}(e)}n.r(t),n.d(t,"fromUtf8",(function(){return r})),n.d(t,"toUtf8",(function(){return i}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayBuffer=void 0,t.isArrayBuffer=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveEventStreamSerdeConfig=void 0;var r=n(0);t.resolveEventStreamSerdeConfig=function(e){return r.__assign(r.__assign({},e),{eventStreamMarshaller:e.eventStreamSerdeProvider(r.__assign({},e))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(134),t),r.__exportStar(n(61),t),r.__exportStar(n(66),t)},function(e,t,n){var r=n(143);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},,function(e,t,n){var r,i,o=n(46),s=n(47),a=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,d=t||[],l=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==f){var p=o();null==l&&(l=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,_=h-a+(v-u)/1e4;if(_<0&&void 0===e.clockseq&&(f=f+1&16383),(_<0||h>a)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,u=v,i=f;var g=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;d[c++]=g>>>24&255,d[c++]=g>>>16&255,d[c++]=g>>>8&255,d[c++]=255&g;var y=h/4294967296*1e4&268435455;d[c++]=y>>>8&255,d[c++]=255&y,d[c++]=y>>>24&15|16,d[c++]=y>>>16&255,d[c++]=f>>>8|128,d[c++]=255&f;for(var m=0;m<6;++m)d[c+m]=l[m];return t||s(d)}},function(e,t,n){var r=n(46),i=n(47);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSerdePlugin=t.serializerMiddlewareOption=t.deserializerMiddlewareOption=void 0;var r=n(48),i=n(49);t.deserializerMiddlewareOption={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"]},t.serializerMiddlewareOption={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"]},t.getSerdePlugin=function(e,n,o){return{applyToStack:function(s){s.add(r.deserializerMiddleware(e,o),t.deserializerMiddlewareOption),s.add(i.serializerMiddleware(e,n),t.serializerMiddlewareOption)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;var r=n(50),i=function(){function e(e){this.middlewareStack=new r.MiddlewareStack,this.config=e}return e.prototype.send=function(e,t,n){var r="function"!=typeof t?t:void 0,i="function"==typeof t?t:n,o=e.resolveMiddleware(this.middlewareStack,this.config,r);if(!i)return o(e).then((function(e){return e.output}));o(e).then((function(e){return i(null,e.output)}),(function(e){return i(e)})).catch((function(){}))},e.prototype.destroy=function(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()},e}();t.Client=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MiddlewareStack=void 0;var r=n(0),i=function(){function e(){this.absoluteEntries=[],this.relativeEntries=[],this.entriesNameMap={}}return e.prototype.add=function(e,t){void 0===t&&(t={});var n=t.name,r=t.step,i=void 0===r?"initialize":r,o=t.tags,s=t.priority,a={name:n,step:i,tags:o,priority:void 0===s?"normal":s,middleware:e};if(n){if(Object.prototype.hasOwnProperty.call(this.entriesNameMap,n))throw new Error("Duplicated middleware name '"+n+"'");this.entriesNameMap[n]=a}this.absoluteEntries.push(a)},e.prototype.addRelativeTo=function(e,t){var n=t.step,r=void 0===n?"initialize":n,i=t.name,o=t.tags,s=t.relation,a=t.toMiddleware,u={middleware:e,step:r,name:i,tags:o,next:"before"===s?a:void 0,prev:"after"===s?a:void 0};if(i){if(Object.prototype.hasOwnProperty.call(this.entriesNameMap,i))throw new Error("Duplicated middleware name '"+i+"'");this.entriesNameMap[i]=u}this.relativeEntries.push(u)},e.prototype.sort=function(e){return e.sort((function(e,t){return o[t.step]-o[e.step]||s[t.priority||"normal"]-s[e.priority||"normal"]}))},e.prototype.clone=function(){var t,n,i=new e;return(t=i.absoluteEntries).push.apply(t,r.__spread(this.absoluteEntries)),(n=i.relativeEntries).push.apply(n,r.__spread(this.relativeEntries)),i.entriesNameMap=r.__assign({},this.entriesNameMap),i},e.prototype.concat=function(t){var n,i,o=new e;o.entriesNameMap=r.__assign({},this.entriesNameMap);var s=t;for(var a in s.entriesNameMap){if(o.entriesNameMap[a])throw new Error("Duplicated middleware name '"+a+"'");o.entriesNameMap[a]=s.entriesNameMap[a]}return(n=o.absoluteEntries).push.apply(n,r.__spread(this.absoluteEntries,s.absoluteEntries)),(i=o.relativeEntries).push.apply(i,r.__spread(this.relativeEntries,s.relativeEntries)),o},e.prototype.remove=function(e){return"string"==typeof e?this.removeByName(e):this.removeByReference(e)},e.prototype.removeByName=function(e){for(var t=this.absoluteEntries.length-1;t>=0;t--)if(this.absoluteEntries[t].name&&this.absoluteEntries[t].name===e)return this.absoluteEntries.splice(t,1),delete this.entriesNameMap[e],!0;for(t=this.relativeEntries.length-1;t>=0;t--)if(this.relativeEntries[t].name&&this.relativeEntries[t].name===e)return this.relativeEntries.splice(t,1),delete this.entriesNameMap[e],!0;return!1},e.prototype.removeByReference=function(e){for(var t=this.absoluteEntries.length-1;t>=0;t--){if(this.absoluteEntries[t].middleware===e)return(n=this.absoluteEntries[t].name)&&delete this.entriesNameMap[n],this.absoluteEntries.splice(t,1),!0}for(t=this.relativeEntries.length-1;t>=0;t--){var n;if(this.relativeEntries[t].middleware===e)return(n=this.relativeEntries[t].name)&&delete this.entriesNameMap[n],this.relativeEntries.splice(t,1),!0}return!1},e.prototype.removeByTag=function(e){for(var t=!1,n=this.absoluteEntries.length-1;n>=0;n--){var r=this.absoluteEntries[n],i=r.tags,o=r.name;i&&i.indexOf(e)>-1&&(this.absoluteEntries.splice(n,1),o&&delete this.entriesNameMap[o],t=!0)}for(n=this.relativeEntries.length-1;n>=0;n--){var s=this.relativeEntries[n];i=s.tags,o=s.name;i&&i.indexOf(e)>-1&&(this.relativeEntries.splice(n,1),o&&delete this.entriesNameMap[o],t=!0)}return t},e.prototype.use=function(e){e.applyToStack(this)},e.prototype.normalizeRelativeEntries=function(){for(var e,t,n=this.absoluteEntries.filter((function(e){return e.name})).reduce((function(e,t){return e[t.name]=t,e}),{}),i=this.relativeEntries.map((function(e){return r.__assign(r.__assign({},e),{priority:null,next:void 0,prev:void 0})})),o=i.filter((function(e){return e.name})).reduce((function(e,t){return e[t.name]=t,e}),{}),s={},a=0;a<this.relativeEntries.length;a++){var u=this.relativeEntries[a],c=u.prev,d=u.next,l=i[a];if(c){if(n[c]&&n[c].step===l.step)s[c]||(s[c]={}),l.next=s[c].next,s[c].next&&(s[c].next.prev=l),s[c].next=l;else if(o[c]&&o[c].step===l.step){var f=o[c];if(f.next===l)continue;l.next=f.next,f.next=l,l.next&&(l.next.prev=l),l.prev=f}}else if(d)if(n[d]&&n[d].step===l.step)s[d]||(s[d]={}),l.prev=s[d].prev,s[d].prev&&(s[d].prev.next=l),s[d].prev=l;else if(o[d]&&o[d].step===l.step){var p=o[d];if(p.prev===l)continue;l.prev=p.prev,p.prev=l,l.prev&&(l.prev.next=l),l.next=p}}var h=[],v=new WeakSet;try{for(var _=r.__values(Object.keys(s)),g=_.next();!g.done;g=_.next()){var y=s[g.value];for(c=y.prev,d=y.next;c;)v.add(c),c=c.prev;for(;d;)v.add(d),d=d.next}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=_.return)&&t.call(_)}finally{if(e)throw e.error}}for(a=0;a<i.length;a++){var m=i[a];if(!v.has(m))for(m.prev||h.push(m);m&&!v.has(m);)v.add(m),m=m.next}return[h,s]},e.prototype.getMiddlewareList=function(){var e,t,n=[],i=r.__read(this.normalizeRelativeEntries(),2),o=i[0],s=i[1],a=r.__spread(this.absoluteEntries,o);a=this.sort(a);try{for(var u=r.__values(a),c=u.next();!c.done;c=u.next()){for(var d=c.value,l={prev:void 0,next:void 0},f=d.name&&s[d.name]||l,p=f.prev,h=f.next,v=p;null==v?void 0:v.prev;)v=v.prev;for(;v;)n.push(v.middleware),v=v.next;n.push(d.middleware);for(var _=d;_.next;)n.push(_.next.middleware),_=_.next;for(v=h;v;)n.push(v.middleware),v=v.next}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return n.reverse()},e.prototype.resolve=function(e,t){var n,i;try{for(var o=r.__values(this.getMiddlewareList()),s=o.next();!s.done;s=o.next()){e=(0,s.value)(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return e},e}();t.MiddlewareStack=i;var o={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},s={high:3,normal:2,low:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Command=void 0;var r=n(50),i=function(){this.middlewareStack=new r.MiddlewareStack};t.Command=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendedEncodeURIComponent=void 0,t.extendedEncodeURIComponent=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getArrayIfSingleItem=void 0,t.getArrayIfSingleItem=function(e){return Array.isArray(e)?e:[e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValueFromTextNode=void 0,t.getValueFromTextNode=function(e){for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]["#text"]?e[n]=e[n]["#text"]:"object"==typeof e[n]&&null!==e[n]&&(e[n]=t.getValueFromTextNode(e[n]));return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isa=void 0,t.isa=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return"object"==typeof e&&("__type"in e&&t.indexOf(e.__type)>-1||"name"in e&&t.indexOf(e.name)>-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyJsonString=t.StringWrapper=void 0;var r=n(0);t.StringWrapper=function(){var e=Object.getPrototypeOf(this).constructor,t=Function.bind.apply(String,r.__spread([null],arguments)),n=new t;return Object.setPrototypeOf(n,e.prototype),n},t.StringWrapper.prototype=Object.create(String.prototype,{constructor:{value:t.StringWrapper,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t.StringWrapper,String);var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.deserializeJSON=function(){return JSON.parse(e.prototype.toString.call(this))},t.prototype.toJSON=function(){return e.prototype.toString.call(this)},t.fromObject=function(e){return e instanceof t?e:new t(e instanceof String||"string"==typeof e?e:JSON.stringify(e))},t}(t.StringWrapper);t.LazyJsonString=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dateToUtcString=void 0;var r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.dateToUtcString=function(e){var t=e.getUTCFullYear(),n=e.getUTCMonth(),o=e.getUTCDay(),s=e.getUTCDate(),a=e.getUTCHours(),u=e.getUTCMinutes(),c=e.getUTCSeconds();return r[o]+", "+(s<10?"0"+s:""+s)+" "+i[n]+" "+t+" "+(a<10?"0"+a:""+a)+":"+(u<10?"0"+u:""+u)+":"+(c<10?"0"+c:""+c)+" GMT"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitEvery=void 0,t.splitEvery=function(e,t,n){if(n<=0||!Number.isInteger(n))throw new Error("Invalid number of delimiters ("+n+") for splitEvery.");var r=e.split(t);if(1===n)return r;for(var i=[],o="",s=0;s<r.length;s++)""===o?o=r[s]:o+=t+r[s],(s+1)%n==0&&(i.push(o),o="");return""!==o&&i.push(o),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SENSITIVE_STRING=void 0,t.SENSITIVE_STRING="***SensitiveInformation***"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpResponse=void 0;var r=function(){function e(e){this.statusCode=e.statusCode,this.headers=e.headers||{},this.body=e.body}return e.isInstance=function(e){if(!e)return!1;var t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers},e}();t.HttpResponse=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequest=void 0;var r=n(0),i=function(){function e(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.substr(-1)?e.protocol+":":e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?"/"+e.path:e.path:"/"}return e.isInstance=function(e){if(!e)return!1;var t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers},e.prototype.clone=function(){var t,n=new e(r.__assign(r.__assign({},this),{headers:r.__assign({},this.headers)}));return n.query&&(n.query=(t=n.query,Object.keys(t).reduce((function(e,n){var i,o=t[n];return r.__assign(r.__assign({},e),((i={})[n]=Array.isArray(o)?r.__spread(o):o,i))}),{}))),n},e}();t.HttpRequest=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidHostname=void 0,t.isValidHostname=function(e){return/^[a-zA-Z0-9]{1}$|^[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9]$/.test(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveEndpointsConfig=t.normalizeEndpoint=void 0;var r=n(0);function i(e,t){if("string"==typeof e){var n=Promise.resolve(t(e));return function(){return n}}if("object"==typeof e){var r=Promise.resolve(e);return function(){return r}}return e}t.normalizeEndpoint=i,t.resolveEndpointsConfig=function(e){var t=this,n=void 0===e.tls||e.tls,o=e.endpoint?i(e.endpoint,e.urlParser):function(){return e.region().then((function(i){return r.__awaiter(t,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,e.regionInfoProvider(i)];case 1:if(!(t=(r.sent()||{}).hostname))throw new Error("Cannot resolve hostname from client config");return[2,e.urlParser((n?"https:":"http:")+"//"+t)]}}))}))}))};return r.__assign(r.__assign({},e),{endpoint:o,tls:n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveRegionConfig=void 0;var r=n(0);function i(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e}t.resolveRegionConfig=function(e){var t=e.region||e.regionDefaultProvider(e);return r.__assign(r.__assign({},e),{region:i(t)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRetryPlugin=t.retryMiddlewareOptions=t.retryMiddleware=void 0;var r=n(0);t.retryMiddleware=function(e){return function(t){return function(n){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,e.retryStrategy.retry(t,n)]}))}))}}},t.retryMiddlewareOptions={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high"},t.getRetryPlugin=function(e){return{applyToStack:function(n){n.add(t.retryMiddleware(e),t.retryMiddlewareOptions)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSIENT_ERROR_STATUS_CODES=t.TRANSIENT_ERROR_CODES=t.THROTTLING_ERROR_CODES=t.CLOCK_SKEW_ERROR_CODES=void 0,t.CLOCK_SKEW_ERROR_CODES=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch"],t.THROTTLING_ERROR_CODES=["Throttling","ThrottlingException","ThrottledException","RequestThrottledException","TooManyRequestsException","ProvisionedThroughputExceededException","TransactionInProgressException","RequestLimitExceeded","BandwidthLimitExceeded","LimitExceededException","RequestThrottled","SlowDown","PriorRequestNotComplete","EC2ThrottledException"],t.TRANSIENT_ERROR_CODES=["AbortError","TimeoutError","RequestTimeout","RequestTimeoutException"],t.TRANSIENT_ERROR_STATUS_CODES=[500,502,503,504]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultRetryQuota=void 0;var r=n(35);t.getDefaultRetryQuota=function(e){var t=e,n=e,i=function(e){return"TimeoutError"===e.name?r.TIMEOUT_RETRY_COST:r.RETRY_COST},o=function(e){return i(e)<=n};return Object.freeze({hasRetryTokens:o,retrieveRetryTokens:function(e){if(!o(e))throw new Error("No retry token available");var t=i(e);return n-=t,t},releaseRetryTokens:function(e){n+=null!=e?e:r.NO_RETRY_INCREMENT,n=Math.min(n,t)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveRetryConfig=void 0;var r=n(0),i=n(51);t.resolveRetryConfig=function(e){var t,n=null!==(t=o(e.maxAttempts))&&void 0!==t?t:e.maxAttemptsDefaultProvider(e);return r.__assign(r.__assign({},e),{maxAttempts:n,retryStrategy:e.retryStrategy||new i.StandardRetryStrategy(n)})};var o=function(e){if(e){var t=Promise.resolve(e.toString());return function(){return t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAwsAuthConfig=void 0;var r=n(0),i=n(217);function o(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e}t.resolveAwsAuthConfig=function(e){var t,n=this,s=o(e.credentials||e.credentialDefaultProvider(e)),a=e.signingEscapePath,u=void 0===a||a,c=e.systemClockOffset,d=void 0===c?e.systemClockOffset||0:c,l=e.sha256;return t=e.signer?o(e.signer):function(){return o(e.region)().then((function(t){return r.__awaiter(n,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,e.regionInfoProvider(t)];case 1:return[2,[n.sent()||{},t]]}}))}))})).then((function(t){var n=r.__read(t,2),o=n[0],a=n[1],c=o.signingRegion,d=void 0===c?e.signingRegion:c,f=o.signingService,p=void 0===f?e.signingName:f;return e.signingRegion=e.signingRegion||d||a,e.signingName=e.signingName||p,new i.SignatureV4({credentials:s,region:e.signingRegion,service:e.signingName,sha256:l,uriEscapePath:u})}))},r.__assign(r.__assign({},e),{systemClockOffset:d,signingEscapePath:u,credentials:s,signer:t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeUriPath=void 0;var r=n(0),i=n(55);t.escapeUriPath=function(e){var t,n,o=[];try{for(var s=r.__values(e.split("/")),a=s.next();!a.done;a=s.next()){var u=a.value;o.push(i.escapeUri(u))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o.join("/")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAwsAuthPlugin=t.awsAuthMiddlewareOptions=t.awsAuthMiddleware=void 0;var r=n(0),i=n(2),o=function(e){return new Date(Date.now()+e)};function s(e){return function(t){return function(n){return r.__awaiter(this,void 0,void 0,(function(){var s,a,u,c,d,l,f,p,h;return r.__generator(this,(function(v){switch(v.label){case 0:return i.HttpRequest.isInstance(n.request)?"function"!=typeof e.signer?[3,2]:[4,e.signer()]:[2,t(n)];case 1:return a=v.sent(),[3,3];case 2:a=e.signer,v.label=3;case 3:return s=a,c=t,d=[r.__assign({},n)],l={},[4,s.sign(n.request,{signingDate:new Date(Date.now()+e.systemClockOffset)})];case 4:return[4,c.apply(void 0,[r.__assign.apply(void 0,d.concat([(l.request=v.sent(),l)]))])];case 5:return u=v.sent(),f=u.response.headers,(p=f&&(f.date||f.Date))&&(h=Date.parse(p),_=h,g=e.systemClockOffset,Math.abs(o(g).getTime()-_)>=3e5&&(e.systemClockOffset=h-Date.now())),[2,u]}var _,g}))}))}}}t.awsAuthMiddleware=s,t.awsAuthMiddlewareOptions={name:"awsAuthMiddleware",step:"finalizeRequest",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware"},t.getAwsAuthPlugin=function(e){return{applyToStack:function(n){n.addRelativeTo(s(e),t.awsAuthMiddlewareOptions)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveUserAgentConfig=void 0,t.resolveUserAgentConfig=function(e){return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAgentPlugin=t.getUserAgentMiddlewareOptions=t.userAgentMiddleware=void 0;var r=n(0),i=n(2);function o(e){return function(t){return function(n){var o=n.request;if(!i.HttpRequest.isInstance(o))return t(n);var s=o.headers,a="node"===e.runtime?"user-agent":"x-amz-user-agent";return s[a]?s[a]+=" "+e.defaultUserAgent:s[a]=""+e.defaultUserAgent,e.customUserAgent&&(s[a]+=" "+e.customUserAgent),t(r.__assign(r.__assign({},n),{request:o}))}}}t.userAgentMiddleware=o,t.getUserAgentMiddlewareOptions={name:"getUserAgentMiddleware",step:"build",tags:["SET_USER_AGENT","USER_AGENT"]},t.getUserAgentPlugin=function(e){return{applyToStack:function(n){n.add(o(e),t.getUserAgentMiddlewareOptions)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(59),o=n(120),s=n(123),a=n(125),u=n(36),c=function(){function e(e){s.supportsWebCrypto(u.locateWindow())?this.hash=new i.Sha256(e):a.isMsWindow(u.locateWindow())?this.hash=new r.Sha256(e):this.hash=new o.Sha256(e)}return e.prototype.update=function(e,t){this.hash.update(e,t)},e.prototype.digest=function(){return this.hash.digest()},e}();t.Sha256=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(121),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(60),o=n(122),s=n(218),a=function(){function e(e){if(this.hash=new o.RawSha256,e){this.outer=new o.RawSha256;var t=function(e){var t=u(e);if(t.byteLength>i.BLOCK_SIZE){var n=new o.RawSha256;n.update(t),t=n.digest()}var r=new Uint8Array(i.BLOCK_SIZE);return r.set(t),r}(e),n=new Uint8Array(i.BLOCK_SIZE);n.set(t);for(var r=0;r<i.BLOCK_SIZE;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(r=0;r<t.byteLength;r++)t[r]=0}}return e.prototype.update=function(e){if(!function(e){if("string"==typeof e)return 0===e.length;return 0===e.byteLength}(e)&&!this.error)try{this.hash.update(u(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,this.digestSync()]}))}))},e}();function u(e){return"string"==typeof e?s.fromUtf8(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.Sha256=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=function(){function e(){this.state=Int32Array.from(r.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>r.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===r.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%r.BLOCK_SIZE>=r.BLOCK_SIZE-8){for(var i=this.bufferLength;i<r.BLOCK_SIZE;i++)t.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(i=this.bufferLength;i<r.BLOCK_SIZE-8;i++)t.setUint8(i,0);t.setUint32(r.BLOCK_SIZE-8,Math.floor(e/4294967296),!0),t.setUint32(r.BLOCK_SIZE-4,e),this.hashBuffer(),this.finished=!0}var o=new Uint8Array(r.DIGEST_LENGTH);for(i=0;i<8;i++)o[4*i]=this.state[i]>>>24&255,o[4*i+1]=this.state[i]>>>16&255,o[4*i+2]=this.state[i]>>>8&255,o[4*i+3]=this.state[i]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],d=t[7],l=0;l<r.BLOCK_SIZE;l++){if(l<16)this.temp[l]=(255&e[4*l])<<24|(255&e[4*l+1])<<16|(255&e[4*l+2])<<8|255&e[4*l+3];else{var f=this.temp[l-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,h=((f=this.temp[l-15])>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[l]=(p+this.temp[l-7]|0)+(h+this.temp[l-16]|0)}var v=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&u^~a&c)|0)+(d+(r.KEY[l]+this.temp[l]|0)|0)|0,_=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&o^i&o)|0;d=c,c=u,u=a,a=s+v|0,s=o,o=i,i=n,n=v+_|0}t[0]+=n,t[1]+=i,t[2]+=o,t[3]+=s,t[4]+=a,t[5]+=u,t[6]+=c,t[7]+=d},e}();t.RawSha256=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(124),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function o(e){return"object"==typeof e&&"object"==typeof e.crypto&&"function"==typeof e.crypto.getRandomValues}function s(e){return e&&i.every((function(t){return"function"==typeof e[t]}))}t.supportsWebCrypto=function(e){return!(!o(e)||"object"!=typeof e.crypto.subtle)&&s(e.crypto.subtle)},t.supportsSecureRandom=o,t.supportsSubtleCrypto=s,t.supportsZeroByteGCM=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:if(!s(e))return[2,!1];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,e.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return t=n.sent(),[4,e.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},t,new Uint8Array(0))];case 3:return[2,16===n.sent().byteLength];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).__exportStar(n(126),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];t.isMsWindow=function(e){if(function(e){return"MSInputMethodContext"in e&&"msCrypto"in e}(e)&&void 0!==e.msCrypto.subtle){var t=e.msCrypto,n=t.getRandomValues,i=t.subtle;return r.map((function(e){return i[e]})).concat(n).every((function(e){return"function"==typeof e}))}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchHttpHandler=void 0;var r=n(0),i=n(2),o=n(128),s=n(129),a=function(){function e(e){void 0===e&&(e={}),this.httpOptions=e}return e.prototype.destroy=function(){},e.prototype.handle=function(e,t){var n=null==t?void 0:t.abortSignal,a=this.httpOptions.requestTimeout;if(null==n?void 0:n.aborted){var u=new Error("Request aborted");return u.name="AbortError",Promise.reject(u)}var c=e.path;if(e.query){var d=o.buildQueryString(e.query);d&&(c+="?"+d)}var l=e.port,f=e.protocol+"//"+e.hostname+(l?":"+l:"")+c,p={body:e.body,headers:new Headers(e.headers),method:e.method};"undefined"!=typeof AbortController&&(p.signal=n);var h=new Request(f,p),v=[fetch(h).then((function(e){var t,n,o=e.headers,s={};try{for(var a=r.__values(o.entries()),u=a.next();!u.done;u=a.next()){var c=u.value;s[c[0]]=c[1]}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return void 0!==e.body?{response:new i.HttpResponse({headers:s,statusCode:e.status,body:e.body})}:e.blob().then((function(t){return{response:new i.HttpResponse({headers:s,statusCode:e.status,body:t})}}))})),s.requestTimeout(a)];return n&&v.push(new Promise((function(e,t){n.onabort=function(){var e=new Error("Request aborted");e.name="AbortError",t(e)}}))),Promise.race(v)},e}();t.FetchHttpHandler=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildQueryString=void 0;var r=n(0),i=n(26);t.buildQueryString=function(e){var t,n,o=[];try{for(var s=r.__values(Object.keys(e).sort()),a=s.next();!a.done;a=s.next()){var u=a.value,c=e[u];if(u=i.escapeUri(u),Array.isArray(c))for(var d=0,l=c.length;d<l;d++)o.push(u+"="+i.escapeUri(c[d]));else{var f=u;(c||"string"==typeof c)&&(f+="="+i.escapeUri(c)),o.push(f)}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o.join("&")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestTimeout=void 0,t.requestTimeout=function(e){return void 0===e&&(e=0),new Promise((function(t,n){e&&setTimeout((function(){var t=new Error("Request did not complete within "+e+" ms");t.name="TimeoutError",n(t)}),e)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamCollector=void 0;var r=n(0),i=n(7);function o(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){var e;if(2!==r.readyState)return n(new Error("Reader aborted too early"));var i=null!==(e=r.result)&&void 0!==e?e:"",o=i.indexOf(","),s=o>-1?o+1:i.length;t(i.substring(s))},r.onabort=function(){return n(new Error("Read aborted"))},r.onerror=function(){return n(r.error)},r.readAsDataURL(e)}))}t.streamCollector=function(e){return e instanceof Blob?function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,o(e)];case 1:return t=r.sent(),n=i.fromBase64(t),[2,new Uint8Array(n)]}}))}))}(e):function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,s,a,u;return r.__generator(this,(function(r){switch(r.label){case 0:t=new Uint8Array(0),n=e.getReader(),i=!1,r.label=1;case 1:return i?[3,3]:[4,n.read()];case 2:return o=r.sent(),s=o.done,(a=o.value)&&(u=t,(t=new Uint8Array(u.length+a.length)).set(u),t.set(a,u.length)),i=s,[3,1];case 3:return[2,t]}}))}))}(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQueryString=void 0;var r=n(0);t.parseQueryString=function(e){var t,n,i={};if(e=e.replace(/^\?/,""))try{for(var o=r.__values(e.split("&")),s=o.next();!s.done;s=o.next()){var a=s.value,u=r.__read(a.split("="),2),c=u[0],d=u[1],l=void 0===d?null:d;c=decodeURIComponent(c),l&&(l=decodeURIComponent(l)),c in i?Array.isArray(i[c])?i[c].push(l):i[c]=[i[c],l]:i[c]=l}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192,63&i|128);else if(n+1<e.length&&55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))){var o=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n));t.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}else t.push(i>>12|224,i>>6&63|128,63&i|128)}return Uint8Array.from(t)},t.toUtf8=function(e){for(var t="",n=0,r=e.length;n<r;n++){var i=e[n];if(i<128)t+=String.fromCharCode(i);else if(192<=i&&i<224){var o=e[++n];t+=String.fromCharCode((31&i)<<6|63&o)}else if(240<=i&&i<365){var s="%"+[i,e[++n],e[++n],e[++n]].map((function(e){return e.toString(16)})).join("%");t+=decodeURIComponent(s)}else t+=String.fromCharCode((15&i)<<12|(63&e[++n])<<6|63&e[++n])}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=function(e){return(new TextEncoder).encode(e)},t.toUtf8=function(e){return new TextDecoder("utf-8").decode(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventStreamSerdeProvider=void 0;var r=n(61);t.eventStreamSerdeProvider=function(e){return new r.EventStreamMarshaller(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventStreamMarshaller=void 0;var r=n(63),i=n(136),o=n(137),s=function(){function e(e,t){this.headerMarshaller=new i.HeaderMarshaller(e,t)}return e.prototype.marshall=function(e){var t=e.headers,n=e.body,i=this.headerMarshaller.format(t),o=i.byteLength+n.byteLength+16,s=new Uint8Array(o),a=new DataView(s.buffer,s.byteOffset,s.byteLength),u=new r.Crc32;return a.setUint32(0,o,!1),a.setUint32(4,i.byteLength,!1),a.setUint32(8,u.update(s.subarray(0,8)).digest(),!1),s.set(i,12),s.set(n,i.byteLength+12),a.setUint32(o-4,u.update(s.subarray(8,o-4)).digest(),!1),s},e.prototype.unmarshall=function(e){var t=o.splitMessage(e),n=t.headers,r=t.body;return{headers:this.headerMarshaller.parse(n),body:r}},e.prototype.formatHeaders=function(e){return this.headerMarshaller.format(e)},e}();t.EventStreamMarshaller=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderMarshaller=void 0;var r,i=n(0),o=n(17),s=n(64),a=function(){function e(e,t){this.toUtf8=e,this.fromUtf8=t}return e.prototype.format=function(e){var t,n,r,o,s=[];try{for(var a=i.__values(Object.keys(e)),u=a.next();!u.done;u=a.next()){var c=u.value,d=this.fromUtf8(c);s.push(Uint8Array.from([d.byteLength]),d,this.formatHeaderValue(e[c]))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}var l=new Uint8Array(s.reduce((function(e,t){return e+t.byteLength}),0)),f=0;try{for(var p=i.__values(s),h=p.next();!h.done;h=p.next()){var v=h.value;l.set(v,f),f+=v.byteLength}}catch(e){r={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return l},e.prototype.formatHeaderValue=function(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":var t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":var n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":var r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":var i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);var a=new Uint8Array(i.buffer);return a.set(e.value,3),a;case"string":var u=this.fromUtf8(e.value),c=new DataView(new ArrayBuffer(3+u.byteLength));c.setUint8(0,7),c.setUint16(1,u.byteLength,!1);var d=new Uint8Array(c.buffer);return d.set(u,3),d;case"timestamp":var l=new Uint8Array(9);return l[0]=8,l.set(s.Int64.fromNumber(e.value.valueOf()).bytes,1),l;case"uuid":if(!g.test(e.value))throw new Error("Invalid UUID received: "+e.value);var f=new Uint8Array(17);return f[0]=9,f.set(o.fromHex(e.value.replace(/\-/g,"")),1),f}},e.prototype.parse=function(e){for(var t={},n=0;n<e.byteLength;){var r=e.getUint8(n++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,r));switch(n+=r,e.getUint8(n++)){case 0:t[i]={type:u,value:!0};break;case 1:t[i]={type:u,value:!1};break;case 2:t[i]={type:c,value:e.getInt8(n++)};break;case 3:t[i]={type:d,value:e.getInt16(n,!1)},n+=2;break;case 4:t[i]={type:l,value:e.getInt32(n,!1)},n+=4;break;case 5:t[i]={type:f,value:new s.Int64(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:var a=e.getUint16(n,!1);n+=2,t[i]={type:p,value:new Uint8Array(e.buffer,e.byteOffset+n,a)},n+=a;break;case 7:var g=e.getUint16(n,!1);n+=2,t[i]={type:h,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,g))},n+=g;break;case 8:t[i]={type:v,value:new Date(new s.Int64(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:var y=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[i]={type:_,value:o.toHex(y.subarray(0,4))+"-"+o.toHex(y.subarray(4,6))+"-"+o.toHex(y.subarray(6,8))+"-"+o.toHex(y.subarray(8,10))+"-"+o.toHex(y.subarray(10))};break;default:throw new Error("Unrecognized header type tag")}}return t},e}();t.HeaderMarshaller=a,function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(r||(r={}));var u="boolean",c="byte",d="short",l="integer",f="long",p="binary",h="string",v="timestamp",_="uuid",g=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitMessage=void 0;var r=n(63);t.splitMessage=function(e){var t=e.byteLength,n=e.byteOffset,i=e.buffer;if(t<16)throw new Error("Provided message too short to accommodate event stream message overhead");var o=new DataView(i,n,t),s=o.getUint32(0,!1);if(t!==s)throw new Error("Reported message length does not match received message length");var a=o.getUint32(4,!1),u=o.getUint32(8,!1),c=o.getUint32(t-4,!1),d=(new r.Crc32).update(new Uint8Array(i,n,8));if(u!==d.digest())throw new Error("The prelude checksum specified in the message ("+u+") does not match the calculated CRC32 checksum ("+d.digest()+")");if(d.update(new Uint8Array(i,n+8,t-12)),c!==d.digest())throw new Error("The message checksum ("+d.digest()+") did not match the expected value of "+c);return{headers:new DataView(i,n+8+4,a),body:new Uint8Array(i,n+8+4+a,s-a-16)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);r.__exportStar(n(140),t),r.__exportStar(n(65),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventStreamSerdeProvider=void 0;var r=n(65);t.eventStreamSerdeProvider=function(e){return new r.EventStreamMarshaller(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChunkedStream=void 0;var r=n(0);t.getChunkedStream=function(e){var t,n=0,i=0,o=null,s=null,a=function(e){if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);n=e,i=4,o=new Uint8Array(e),new DataView(o.buffer).setUint32(0,e,!1)};return(t={})[Symbol.asyncIterator]=function(){return r.__asyncGenerator(this,arguments,(function(){var t,u,c,d,l,f,p,h;return r.__generator(this,(function(v){switch(v.label){case 0:t=e[Symbol.asyncIterator](),v.label=1;case 1:return[4,r.__await(t.next())];case 2:return u=v.sent(),c=u.value,u.done?n?[3,4]:[4,r.__await(void 0)]:[3,10];case 3:return[2,v.sent()];case 4:return n!==i?[3,7]:[4,r.__await(o)];case 5:return[4,v.sent()];case 6:return v.sent(),[3,8];case 7:throw new Error("Truncated event message received.");case 8:return[4,r.__await(void 0)];case 9:return[2,v.sent()];case 10:d=c.length,l=0,v.label=11;case 11:if(!(l<d))return[3,15];if(!o){if(f=d-l,s||(s=new Uint8Array(4)),p=Math.min(4-i,f),s.set(c.slice(l,l+p),i),l+=p,(i+=p)<4)return[3,15];a(new DataView(s.buffer).getUint32(0,!1)),s=null}return h=Math.min(n-i,d-l),o.set(c.slice(l,l+h),i),i+=h,l+=h,n&&n===i?[4,r.__await(o)]:[3,14];case 12:return[4,v.sent()];case 13:v.sent(),o=null,n=0,i=0,v.label=14;case 14:return[3,11];case 15:return[3,1];case 16:return[2]}}))}))},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnmarshalledStream=void 0;var r=n(0);t.getUnmarshalledStream=function(e,t){var n;return(n={})[Symbol.asyncIterator]=function(){return r.__asyncGenerator(this,arguments,(function(){var n,i,o,s,a,u,c,d,l,f,p,h,v,_,g,y,m;return r.__generator(this,(function(b){switch(b.label){case 0:b.trys.push([0,12,13,18]),n=r.__asyncValues(e),b.label=1;case 1:return[4,r.__await(n.next())];case 2:if((i=b.sent()).done)return[3,11];if(o=i.value,s=t.eventMarshaller.unmarshall(o),"error"!==(a=s.headers[":message-type"].value))return[3,3];throw(u=new Error(s.headers[":error-message"].value||"UnknownError")).name=s.headers[":error-code"].value,u;case 3:return"exception"!==a?[3,5]:(c=s.headers[":exception-type"].value,(_={})[c]=s,d=_,[4,r.__await(t.deserializer(d))]);case 4:if((l=b.sent()).$unknown)throw(f=new Error(t.toUtf8(s.body))).name=c,f;throw l[c];case 5:return"event"!==a?[3,9]:((g={})[s.headers[":event-type"].value]=s,p=g,[4,r.__await(t.deserializer(p))]);case 6:return(h=b.sent()).$unknown?[3,10]:[4,r.__await(h)];case 7:return[4,b.sent()];case 8:return b.sent(),[3,10];case 9:throw Error("Unrecognizable event type: "+s.headers[":event-type"].value);case 10:return[3,1];case 11:return[3,18];case 12:return v=b.sent(),y={error:v},[3,18];case 13:return b.trys.push([13,,16,17]),i&&!i.done&&(m=n.return)?[4,r.__await(m.call(n))]:[3,15];case 14:b.sent(),b.label=15;case 15:return[3,17];case 16:if(y)throw y.error;return[7];case 17:return[7];case 18:return[2]}}))}))},n}},function(e,t,n){var r=n(144),i=n(176);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},function(e,t,n){var r=n(23),i=n(145),o=n(149),s=n(173);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},function(e,t,n){var r=n(23),i=n(37),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(29),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(150),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},function(e,t,n){var r=n(151);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(38);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(153),i=n(31),o=n(39);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(e,t,n){var r=n(154),i=n(159),o=n(160),s=n(161),a=n(162);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(30);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t,n){var r=n(68),i=n(156),o=n(69),s=n(70),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?f:a).test(s(e))}},function(e,t,n){var r,i=n(157),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(16)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(30),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(30),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(30);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(32),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(32);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(32);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(32);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(33);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(33);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(33);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(33);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(174);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(29),i=n(175),o=n(23),s=n(37),a=r?r.prototype:void 0,u=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},function(e,t,n){var r=n(37);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(178)(Object.keys,Object);e.exports=r},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(24)(n(16),"DataView");e.exports=r},function(e,t,n){var r=n(24)(n(16),"Promise");e.exports=r},function(e,t,n){var r=n(24)(n(16),"Set");e.exports=r},function(e,t,n){var r=n(24)(n(16),"WeakMap");e.exports=r},function(e,t,n){var r=n(27),i=n(28);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(27),i=n(77),o=n(28),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(67),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(78)(e))},function(e,t,n){var r=n(189),i=n(28);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},function(e,t,n){var r=n(190),i=n(79),o=n(201),s=n(205),a=n(74),u=n(23),c=n(40),d=n(41),l="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,p,h,v){var _=u(e),g=u(t),y=_?"[object Array]":a(e),m=g?"[object Array]":a(t),b=(y="[object Arguments]"==y?l:y)==l,w=(m="[object Arguments]"==m?l:m)==l,O=y==m;if(O&&c(e)){if(!c(t))return!1;_=!0,b=!1}if(O&&!b)return v||(v=new r),_||d(e)?i(e,t,n,p,h,v):o(e,t,y,n,p,h,v);if(!(1&n)){var E=b&&f.call(e,"__wrapped__"),S=w&&f.call(t,"__wrapped__");if(E||S){var j=E?e.value():e,A=S?t.value():t;return v||(v=new r),h(j,A,n,p,v)}}return!!O&&(v||(v=new r),s(e,t,n,p,h,v))}},function(e,t,n){var r=n(31),i=n(191),o=n(192),s=n(193),a=n(194),u=n(195);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,e.exports=c},function(e,t,n){var r=n(31);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(31),i=n(39),o=n(38);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(38),i=n(197),o=n(198);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(29),i=n(202),o=n(71),s=n(79),a=n(203),u=n(204),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,l,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=a;case"[object Set]":var h=1&r;if(p||(p=u),e.size!=t.size&&!h)return!1;var v=f.get(e);if(v)return v==t;r|=2,f.set(e,t);var _=s(p(e),p(t),r,c,l,f);return f.delete(e),_;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},function(e,t,n){var r=n(16).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(206),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var u=1&n,c=r(e),d=c.length;if(d!=r(t).length&&!u)return!1;for(var l=d;l--;){var f=c[l];if(!(u?f in t:i.call(t,f)))return!1}var p=a.get(e),h=a.get(t);if(p&&h)return p==t&&h==e;var v=!0;a.set(e,t),a.set(t,e);for(var _=u;++l<d;){var g=e[f=c[l]],y=t[f];if(o)var m=u?o(y,g,f,t,e,a):o(g,y,f,e,t,a);if(!(void 0===m?g===y||s(g,y,n,o,a):m)){v=!1;break}_||(_="constructor"==f)}if(v&&!_){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(v=!1)}return a.delete(e),a.delete(t),v}},function(e,t,n){var r=n(207),i=n(209),o=n(212);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(208),i=n(23);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(210),i=n(211),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(213),i=n(72),o=n(76);e.exports=function(e){return o(e)?r(e):i(e)}},function(e,t,n){var r=n(214),i=n(75),o=n(23),s=n(40),a=n(215),u=n(41),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),d=!n&&i(e),l=!n&&!d&&s(e),f=!n&&!d&&!l&&u(e),p=n||d||l||f,h=p?r(e.length,String):[],v=h.length;for(var _ in e)!t&&!c.call(e,_)||p&&("length"==_||l&&("offset"==_||"parent"==_)||f&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||a(_,v))||h.push(_);return h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){"use strict";n.r(t),n.d(t,"Analytics",(function(){return Ct})),n.d(t,"AWSPinpointProvider",(function(){return Be})),n.d(t,"AWSKinesisProvider",(function(){return An})),n.d(t,"AWSKinesisFirehoseProvider",(function(){return rr})),n.d(t,"AmazonPersonalizeProvider",(function(){return Cr}));var r=n(3),i=n(0),o=n(2),s=n(1),a=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,_,g,y,m,b,w;return Object(i.__generator)(this,(function(O){switch(O.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,V(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=O.sent(),o)])),a="UnknownError",a=K(e,n.body),a){case"BadRequestException":case"com.amazonaws.pinpoint#BadRequestException":return[3,2];case"ForbiddenException":case"com.amazonaws.pinpoint#ForbiddenException":return[3,4];case"InternalServerErrorException":case"com.amazonaws.pinpoint#InternalServerErrorException":return[3,6];case"MethodNotAllowedException":case"com.amazonaws.pinpoint#MethodNotAllowedException":return[3,8];case"NotFoundException":case"com.amazonaws.pinpoint#NotFoundException":return[3,10];case"TooManyRequestsException":case"com.amazonaws.pinpoint#TooManyRequestsException":return[3,12]}return[3,14];case 2:return u=[{}],[4,d(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,u.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 4:return c=[{}],[4,l(n,t)];case 5:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,c.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 6:return _=[{}],[4,f(n,t)];case 7:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,_.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 8:return g=[{}],[4,p(n,t)];case 9:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,g.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 10:return y=[{}],[4,h(n,t)];case 11:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,y.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 12:return m=[{}],[4,v(n,t)];case 13:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,m.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 14:b=n.body,a=b.code||b.Code||a,s=Object(i.__assign)(Object(i.__assign)({},b),{name:""+a,message:b.message||b.Message||a,$fault:"client",$metadata:F(e)}),O.label=15;case 15:return w=s.message||s.Message||a,s.message=w,delete s.Message,[2,Promise.reject(Object.assign(new Error(w),s))]}}))}))},u=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,_,g,y,m,b,w;return Object(i.__generator)(this,(function(O){switch(O.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,V(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=O.sent(),o)])),a="UnknownError",a=K(e,n.body),a){case"BadRequestException":case"com.amazonaws.pinpoint#BadRequestException":return[3,2];case"ForbiddenException":case"com.amazonaws.pinpoint#ForbiddenException":return[3,4];case"InternalServerErrorException":case"com.amazonaws.pinpoint#InternalServerErrorException":return[3,6];case"MethodNotAllowedException":case"com.amazonaws.pinpoint#MethodNotAllowedException":return[3,8];case"NotFoundException":case"com.amazonaws.pinpoint#NotFoundException":return[3,10];case"TooManyRequestsException":case"com.amazonaws.pinpoint#TooManyRequestsException":return[3,12]}return[3,14];case 2:return u=[{}],[4,d(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,u.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 4:return c=[{}],[4,l(n,t)];case 5:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,c.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 6:return _=[{}],[4,f(n,t)];case 7:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,_.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 8:return g=[{}],[4,p(n,t)];case 9:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,g.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 10:return y=[{}],[4,h(n,t)];case 11:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,y.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 12:return m=[{}],[4,v(n,t)];case 13:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,m.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 14:b=n.body,a=b.code||b.Code||a,s=Object(i.__assign)(Object(i.__assign)({},b),{name:""+a,message:b.message||b.Message||a,$fault:"client",$metadata:F(e)}),O.label=15;case 15:return w=s.message||s.Message||a,s.message=w,delete s.Message,[2,Promise.reject(Object.assign(new Error(w),s))]}}))}))},c=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,_,g,y,m,b,w;return Object(i.__generator)(this,(function(O){switch(O.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,V(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=O.sent(),o)])),a="UnknownError",a=K(e,n.body),a){case"BadRequestException":case"com.amazonaws.pinpoint#BadRequestException":return[3,2];case"ForbiddenException":case"com.amazonaws.pinpoint#ForbiddenException":return[3,4];case"InternalServerErrorException":case"com.amazonaws.pinpoint#InternalServerErrorException":return[3,6];case"MethodNotAllowedException":case"com.amazonaws.pinpoint#MethodNotAllowedException":return[3,8];case"NotFoundException":case"com.amazonaws.pinpoint#NotFoundException":return[3,10];case"TooManyRequestsException":case"com.amazonaws.pinpoint#TooManyRequestsException":return[3,12]}return[3,14];case 2:return u=[{}],[4,d(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,u.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 4:return c=[{}],[4,l(n,t)];case 5:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,c.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 6:return _=[{}],[4,f(n,t)];case 7:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,_.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 8:return g=[{}],[4,p(n,t)];case 9:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,g.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 10:return y=[{}],[4,h(n,t)];case 11:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,y.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 12:return m=[{}],[4,v(n,t)];case 13:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,m.concat([O.sent()])),{name:a,$metadata:F(e)}]),[3,15];case 14:b=n.body,a=b.code||b.Code||a,s=Object(i.__assign)(Object(i.__assign)({},b),{name:""+a,message:b.message||b.Message||a,$fault:"client",$metadata:F(e)}),O.label=15;case 15:return w=s.message||s.Message||a,s.message=w,delete s.Message,[2,Promise.reject(Object.assign(new Error(w),s))]}}))}))},d=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"BadRequestException",$fault:"client",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},l=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"ForbiddenException",$fault:"client",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},f=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"InternalServerErrorException",$fault:"server",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},p=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"MethodNotAllowedException",$fault:"client",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},h=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"NotFoundException",$fault:"client",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},v=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"TooManyRequestsException",$fault:"client",$metadata:F(e),Message:void 0,RequestID:void 0},void 0!==(n=e.body).Message&&null!==n.Message&&(t.Message=n.Message),void 0!==n.RequestID&&null!==n.RequestID&&(t.RequestID=n.RequestID),[2,t]}))}))},_=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.AppVersion&&{AppVersion:e.AppVersion}),void 0!==e.Locale&&{Locale:e.Locale}),void 0!==e.Make&&{Make:e.Make}),void 0!==e.Model&&{Model:e.Model}),void 0!==e.ModelVersion&&{ModelVersion:e.ModelVersion}),void 0!==e.Platform&&{Platform:e.Platform}),void 0!==e.PlatformVersion&&{PlatformVersion:e.PlatformVersion}),void 0!==e.Timezone&&{Timezone:e.Timezone})},g=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.City&&{City:e.City}),void 0!==e.Country&&{Country:e.Country}),void 0!==e.Latitude&&{Latitude:e.Latitude}),void 0!==e.Longitude&&{Longitude:e.Longitude}),void 0!==e.PostalCode&&{PostalCode:e.PostalCode}),void 0!==e.Region&&{Region:e.Region})},y=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.Address&&{Address:e.Address}),void 0!==e.Attributes&&{Attributes:A(e.Attributes,t)}),void 0!==e.ChannelType&&{ChannelType:e.ChannelType}),void 0!==e.Demographic&&{Demographic:_(e.Demographic,t)}),void 0!==e.EffectiveDate&&{EffectiveDate:e.EffectiveDate}),void 0!==e.EndpointStatus&&{EndpointStatus:e.EndpointStatus}),void 0!==e.Location&&{Location:g(e.Location,t)}),void 0!==e.Metrics&&{Metrics:O(e.Metrics,t)}),void 0!==e.OptOut&&{OptOut:e.OptOut}),void 0!==e.RequestId&&{RequestId:e.RequestId}),void 0!==e.User&&{User:m(e.User,t)})},m=function(e,t){return Object(i.__assign)(Object(i.__assign)({},void 0!==e.UserAttributes&&{UserAttributes:A(e.UserAttributes,t)}),void 0!==e.UserId&&{UserId:e.UserId})},b=function(e,t){return Object(i.__assign)({},void 0!==e.BatchItem&&{BatchItem:j(e.BatchItem,t)})},w=function(e,t){return e.map((function(e){return e}))},O=function(e,t){return Object.entries(e).reduce((function(e,t){var n,r=Object(i.__read)(t,2),o=r[0],s=r[1];return Object(i.__assign)(Object(i.__assign)({},e),((n={})[o]=s,n))}),{})},E=function(e,t){return Object.entries(e).reduce((function(e,t){var n,r=Object(i.__read)(t,2),o=r[0],s=r[1];return Object(i.__assign)(Object(i.__assign)({},e),((n={})[o]=s,n))}),{})},S=function(e,t){return Object.entries(e).reduce((function(e,n){var r,o=Object(i.__read)(n,2),s=o[0],a=o[1];return Object(i.__assign)(Object(i.__assign)({},e),((r={})[s]=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.AppPackageName&&{AppPackageName:e.AppPackageName}),void 0!==e.AppTitle&&{AppTitle:e.AppTitle}),void 0!==e.AppVersionCode&&{AppVersionCode:e.AppVersionCode}),void 0!==e.Attributes&&{Attributes:E(e.Attributes,t)}),void 0!==e.ClientSdkVersion&&{ClientSdkVersion:e.ClientSdkVersion}),void 0!==e.EventType&&{EventType:e.EventType}),void 0!==e.Metrics&&{Metrics:O(e.Metrics,t)}),void 0!==e.SdkName&&{SdkName:e.SdkName}),void 0!==e.Session&&{Session:I(e.Session,t)}),void 0!==e.Timestamp&&{Timestamp:e.Timestamp})}(a,t),r))}),{})},j=function(e,t){return Object.entries(e).reduce((function(e,n){var r,o=Object(i.__read)(n,2),s=o[0],a=o[1];return Object(i.__assign)(Object(i.__assign)({},e),((r={})[s]=function(e,t){return Object(i.__assign)(Object(i.__assign)({},void 0!==e.Endpoint&&{Endpoint:x(e.Endpoint,t)}),void 0!==e.Events&&{Events:S(e.Events,t)})}(a,t),r))}),{})},A=function(e,t){return Object.entries(e).reduce((function(e,n){var r,o=Object(i.__read)(n,2),s=o[0],a=o[1];return Object(i.__assign)(Object(i.__assign)({},e),((r={})[s]=w(a,t),r))}),{})},x=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.Address&&{Address:e.Address}),void 0!==e.Attributes&&{Attributes:A(e.Attributes,t)}),void 0!==e.ChannelType&&{ChannelType:e.ChannelType}),void 0!==e.Demographic&&{Demographic:_(e.Demographic,t)}),void 0!==e.EffectiveDate&&{EffectiveDate:e.EffectiveDate}),void 0!==e.EndpointStatus&&{EndpointStatus:e.EndpointStatus}),void 0!==e.Location&&{Location:g(e.Location,t)}),void 0!==e.Metrics&&{Metrics:O(e.Metrics,t)}),void 0!==e.OptOut&&{OptOut:e.OptOut}),void 0!==e.RequestId&&{RequestId:e.RequestId}),void 0!==e.User&&{User:m(e.User,t)})},I=function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.Duration&&{Duration:e.Duration}),void 0!==e.Id&&{Id:e.Id}),void 0!==e.StartTimestamp&&{StartTimestamp:e.StartTimestamp}),void 0!==e.StopTimestamp&&{StopTimestamp:e.StopTimestamp})},P=function(e,t){return{__type:"EndpointDemographic",AppVersion:void 0!==e.AppVersion&&null!==e.AppVersion?e.AppVersion:void 0,Locale:void 0!==e.Locale&&null!==e.Locale?e.Locale:void 0,Make:void 0!==e.Make&&null!==e.Make?e.Make:void 0,Model:void 0!==e.Model&&null!==e.Model?e.Model:void 0,ModelVersion:void 0!==e.ModelVersion&&null!==e.ModelVersion?e.ModelVersion:void 0,Platform:void 0!==e.Platform&&null!==e.Platform?e.Platform:void 0,PlatformVersion:void 0!==e.PlatformVersion&&null!==e.PlatformVersion?e.PlatformVersion:void 0,Timezone:void 0!==e.Timezone&&null!==e.Timezone?e.Timezone:void 0}},M=function(e,t){return{__type:"EndpointItemResponse",Message:void 0!==e.Message&&null!==e.Message?e.Message:void 0,StatusCode:void 0!==e.StatusCode&&null!==e.StatusCode?e.StatusCode:void 0}},T=function(e,t){return{__type:"EndpointLocation",City:void 0!==e.City&&null!==e.City?e.City:void 0,Country:void 0!==e.Country&&null!==e.Country?e.Country:void 0,Latitude:void 0!==e.Latitude&&null!==e.Latitude?e.Latitude:void 0,Longitude:void 0!==e.Longitude&&null!==e.Longitude?e.Longitude:void 0,PostalCode:void 0!==e.PostalCode&&null!==e.PostalCode?e.PostalCode:void 0,Region:void 0!==e.Region&&null!==e.Region?e.Region:void 0}},C=function(e,t){return{__type:"EndpointResponse",Address:void 0!==e.Address&&null!==e.Address?e.Address:void 0,ApplicationId:void 0!==e.ApplicationId&&null!==e.ApplicationId?e.ApplicationId:void 0,Attributes:void 0!==e.Attributes&&null!==e.Attributes?H(e.Attributes,t):void 0,ChannelType:void 0!==e.ChannelType&&null!==e.ChannelType?e.ChannelType:void 0,CohortId:void 0!==e.CohortId&&null!==e.CohortId?e.CohortId:void 0,CreationDate:void 0!==e.CreationDate&&null!==e.CreationDate?e.CreationDate:void 0,Demographic:void 0!==e.Demographic&&null!==e.Demographic?P(e.Demographic):void 0,EffectiveDate:void 0!==e.EffectiveDate&&null!==e.EffectiveDate?e.EffectiveDate:void 0,EndpointStatus:void 0!==e.EndpointStatus&&null!==e.EndpointStatus?e.EndpointStatus:void 0,Id:void 0!==e.Id&&null!==e.Id?e.Id:void 0,Location:void 0!==e.Location&&null!==e.Location?T(e.Location):void 0,Metrics:void 0!==e.Metrics&&null!==e.Metrics?L(e.Metrics,t):void 0,OptOut:void 0!==e.OptOut&&null!==e.OptOut?e.OptOut:void 0,RequestId:void 0!==e.RequestId&&null!==e.RequestId?e.RequestId:void 0,User:void 0!==e.User&&null!==e.User?k(e.User,t):void 0}},R=function(e,t){return{__type:"EndpointsResponse",Item:void 0!==e.Item&&null!==e.Item?z(e.Item,t):void 0}},k=function(e,t){return{__type:"EndpointUser",UserAttributes:void 0!==e.UserAttributes&&null!==e.UserAttributes?H(e.UserAttributes,t):void 0,UserId:void 0!==e.UserId&&null!==e.UserId?e.UserId:void 0}},U=function(e,t){return{__type:"EventsResponse",Results:void 0!==e.Results&&null!==e.Results?q(e.Results,t):void 0}},D=function(e,t){return(e||[]).map((function(e){return e}))},z=function(e,t){return(e||[]).map((function(e){return C(e,t)}))},L=function(e,t){return Object.entries(e).reduce((function(e,t){var n,r=Object(i.__read)(t,2),o=r[0],s=r[1];return Object(i.__assign)(Object(i.__assign)({},e),((n={})[o]=s,n))}),{})},N=function(e,t){return Object.entries(e).reduce((function(e,t){var n,r=Object(i.__read)(t,2),o=r[0],s=r[1];return Object(i.__assign)(Object(i.__assign)({},e),((n={})[o]=function(e,t){return{__type:"EventItemResponse",Message:void 0!==e.Message&&null!==e.Message?e.Message:void 0,StatusCode:void 0!==e.StatusCode&&null!==e.StatusCode?e.StatusCode:void 0}}(s),n))}),{})},q=function(e,t){return Object.entries(e).reduce((function(e,n){var r,o=Object(i.__read)(n,2),s=o[0],a=o[1];return Object(i.__assign)(Object(i.__assign)({},e),((r={})[s]=function(e,t){return{__type:"ItemResponse",EndpointItemResponse:void 0!==e.EndpointItemResponse&&null!==e.EndpointItemResponse?M(e.EndpointItemResponse):void 0,EventsItemResponse:void 0!==e.EventsItemResponse&&null!==e.EventsItemResponse?N(e.EventsItemResponse,t):void 0}}(a,t),r))}),{})},H=function(e,t){return Object.entries(e).reduce((function(e,n){var r,o=Object(i.__read)(n,2),s=o[0],a=o[1];return Object(i.__assign)(Object(i.__assign)({},e),((r={})[s]=D(a,t),r))}),{})},B=function(e,t){return{__type:"MessageBody",Message:void 0!==e.Message&&null!==e.Message?e.Message:void 0,RequestID:void 0!==e.RequestID&&null!==e.RequestID?e.RequestID:void 0}},F=function(e){return{httpStatusCode:e.statusCode,httpHeaders:e.headers,requestId:e.headers["x-amzn-requestid"]}},$=function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)},V=function(e,t){return function(e,t){return $(e,t).then((function(e){return t.utf8Encoder(e)}))}(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},K=function(e,t){var n,r,i=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},o=(n=e.headers,r="x-amzn-errortype",Object.keys(n).find((function(e){return e.toLowerCase()===r.toLowerCase()})));return void 0!==o?i(e.headers[o]):void 0!==t.code?i(t.code):void 0!==t.__type?i(t.__type):""},W=n(8),Y=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a,u,c,d,l,f,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(n={"Content-Type":"application/json"},r="/v1/apps/{ApplicationId}/events",void 0===e.ApplicationId)throw new Error("No value provided for input HTTP label: ApplicationId.");if((a=e.ApplicationId).length<=0)throw new Error("Empty value provided for input HTTP label: ApplicationId.");return r=r.replace("{ApplicationId}",Object(s.extendedEncodeURIComponent)(a)),void 0!==e.EventsRequest&&(u=b(e.EventsRequest,t)),void 0===u&&(u={}),u=JSON.stringify(u),[4,t.endpoint()];case 1:return c=i.sent(),d=c.hostname,l=c.protocol,f=void 0===l?"https":l,p=c.port,[2,new o.HttpRequest({protocol:f,hostname:d,port:p,method:"POST",headers:n,path:r,body:u})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return 202!==e.statusCode&&e.statusCode>=400?[2,u(e,t)]:(n={$metadata:F(e),__type:"PutEventsResponse",EventsResponse:void 0},[4,V(e.body,t)]);case 1:return r=i.sent(),n.EventsResponse=U(r,t),[2,Promise.resolve(n)]}}))}))}(e,t)},t}(s.Command),G=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a,u,c,d,l,f,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(n={"Content-Type":"application/json"},r="/v1/apps/{ApplicationId}/endpoints/{EndpointId}",void 0===e.ApplicationId)throw new Error("No value provided for input HTTP label: ApplicationId.");if((a=e.ApplicationId).length<=0)throw new Error("Empty value provided for input HTTP label: ApplicationId.");if(r=r.replace("{ApplicationId}",Object(s.extendedEncodeURIComponent)(a)),void 0===e.EndpointId)throw new Error("No value provided for input HTTP label: EndpointId.");if((a=e.EndpointId).length<=0)throw new Error("Empty value provided for input HTTP label: EndpointId.");return r=r.replace("{EndpointId}",Object(s.extendedEncodeURIComponent)(a)),void 0!==e.EndpointRequest&&(u=y(e.EndpointRequest,t)),void 0===u&&(u={}),u=JSON.stringify(u),[4,t.endpoint()];case 1:return c=i.sent(),d=c.hostname,l=c.protocol,f=void 0===l?"https":l,p=c.port,[2,new o.HttpRequest({protocol:f,hostname:d,port:p,method:"PUT",headers:n,path:r,body:u})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return 202!==e.statusCode&&e.statusCode>=400?[2,c(e,t)]:(n={$metadata:F(e),__type:"UpdateEndpointResponse",MessageBody:void 0},[4,V(e.body,t)]);case 1:return r=i.sent(),n.MessageBody=B(r,t),[2,Promise.resolve(n)]}}))}))}(e,t)},t}(s.Command),J=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a,u,c,d,l,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(n={"Content-Type":""},r="/v1/apps/{ApplicationId}/users/{UserId}",void 0===e.ApplicationId)throw new Error("No value provided for input HTTP label: ApplicationId.");if((a=e.ApplicationId).length<=0)throw new Error("Empty value provided for input HTTP label: ApplicationId.");if(r=r.replace("{ApplicationId}",Object(s.extendedEncodeURIComponent)(a)),void 0===e.UserId)throw new Error("No value provided for input HTTP label: UserId.");if((a=e.UserId).length<=0)throw new Error("Empty value provided for input HTTP label: UserId.");return r=r.replace("{UserId}",Object(s.extendedEncodeURIComponent)(a)),[4,t.endpoint()];case 1:return u=i.sent(),c=u.hostname,d=u.protocol,l=void 0===d?"https":d,f=u.port,[2,new o.HttpRequest({protocol:l,hostname:c,port:f,method:"GET",headers:n,path:r,body:void 0})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return 200!==e.statusCode&&e.statusCode>=400?[2,a(e,t)]:(n={$metadata:F(e),__type:"GetUserEndpointsResponse",EndpointsResponse:void 0},[4,V(e.body,t)]);case 1:return r=i.sent(),n.EndpointsResponse=R(r,t),[2,Promise.resolve(n)]}}))}))}(e,t)},t}(s.Command),Z=n(42),X=n(19),Q=n(14),ee=n(15),te=n(20),ne=n(7),re=n(21),ie=n(22),oe=n(4),se=new Set(["ap-south-1","eu-north-1","eu-west-3","eu-west-2","eu-west-1","ap-northeast-2","ap-northeast-1","me-south-1","ca-central-1","sa-east-1","ap-east-1","ap-southeast-1","ap-southeast-2","eu-central-1","us-east-1","us-east-2","us-west-1","us-west-2"]),ae=new Set(["cn-north-1","cn-northwest-1"]),ue=new Set(["us-iso-east-1"]),ce=new Set(["us-isob-east-1"]),de=new Set(["us-gov-west-1","us-gov-east-1"]),le={apiVersion:"2016-12-01",disableHostPrefix:!1,regionInfoProvider:function(e,t){var n=void 0;switch(e){case"ap-south-1":n={hostname:"pinpoint.ap-south-1.amazonaws.com",signingService:"mobiletargeting"};break;case"ap-southeast-2":n={hostname:"pinpoint.ap-southeast-2.amazonaws.com",signingService:"mobiletargeting"};break;case"eu-central-1":n={hostname:"pinpoint.eu-central-1.amazonaws.com",signingService:"mobiletargeting"};break;case"eu-west-1":n={hostname:"pinpoint.eu-west-1.amazonaws.com",signingService:"mobiletargeting"};break;case"us-east-1":n={hostname:"pinpoint.us-east-1.amazonaws.com",signingService:"mobiletargeting"};break;case"us-west-2":n={hostname:"pinpoint.us-west-2.amazonaws.com",signingService:"mobiletargeting"};break;default:se.has(e)&&(n={hostname:"pinpoint.{region}.amazonaws.com".replace("{region}",e),signingService:"mobiletargeting"}),ae.has(e)&&(n={hostname:"pinpoint.{region}.amazonaws.com.cn".replace("{region}",e)}),ue.has(e)&&(n={hostname:"pinpoint.{region}.c2s.ic.gov".replace("{region}",e)}),ce.has(e)&&(n={hostname:"pinpoint.{region}.sc2s.sgov.gov".replace("{region}",e)}),de.has(e)&&(n={hostname:"pinpoint.{region}.amazonaws.com".replace("{region}",e)}),void 0===n&&(n={hostname:"pinpoint.{region}.amazonaws.com".replace("{region}",e),signingService:"mobiletargeting"})}return Promise.resolve(n)},signingName:"mobiletargeting"},fe=Object(i.__assign)(Object(i.__assign)({},le),{runtime:"browser",base64Decoder:ne.fromBase64,base64Encoder:ne.toBase64,bodyLengthChecker:re.calculateBodyLength,credentialDefaultProvider:Object(ee.invalidFunction)("Credential is missing"),defaultUserAgent:Object(ie.defaultUserAgent)(Z.a,Z.b),maxAttemptsDefaultProvider:function(){return"3"},regionDefaultProvider:Object(ee.invalidFunction)("Region is missing"),requestHandler:new Q.FetchHttpHandler,sha256:X.Sha256,streamCollector:Q.streamCollector,urlParser:te.parseUrl,utf8Decoder:oe.fromUtf8,utf8Encoder:oe.toUtf8}),pe=n(9),he=n(18),ve=n(10),_e=n(11),ge=n(12),ye=n(13),me=function(e){function t(t){var n=this,r=Object(i.__assign)(Object(i.__assign)({},fe),t),o=Object(pe.resolveRegionConfig)(r),s=Object(pe.resolveEndpointsConfig)(o),a=Object(ge.resolveAwsAuthConfig)(s),u=Object(_e.resolveRetryConfig)(a),c=Object(ye.resolveUserAgentConfig)(u),d=Object(ve.resolveHostHeaderConfig)(c);return(n=e.call(this,d)||this).config=d,n.middlewareStack.use(Object(ge.getAwsAuthPlugin)(n.config)),n.middlewareStack.use(Object(_e.getRetryPlugin)(n.config)),n.middlewareStack.use(Object(ye.getUserAgentPlugin)(n.config)),n.middlewareStack.use(Object(he.getContentLengthPlugin)(n.config)),n.middlewareStack.use(Object(ve.getHostHeaderPlugin)(n.config)),n}return Object(i.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(s.Client),be=n(25),we=n.n(be),Oe=n(6),Ee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Se=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},je=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},Ae=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(je(arguments[t]));return e},xe=new r.ConsoleLogger("EventsBuffer"),Ie=[429,500],Pe=[202],Me=function(){function e(e,t){this._pause=!1,this._flush=!1,xe.debug("Instantiating buffer with config:",t),this._buffer=[],this._client=e,this._config=t,this._sendBatch=this._sendBatch.bind(this),this._startLoop()}return e.prototype.push=function(e){var t;if(this._buffer>this._config.bufferSize)return xe.debug("Exceeded analytics events buffer size"),e.handlers.reject(new Error("Exceeded the size of analytics events buffer"));var n=((t={})[e.params.event.eventId]=e,t);this._buffer.push(n)},e.prototype.pause=function(){this._pause=!0},e.prototype.resume=function(){this._pause=!1},e.prototype.updateClient=function(e){this._client=e},e.prototype.flush=function(){this._flush=!0},e.prototype._startLoop=function(){this._interval&&clearInterval(this._interval);var e=this._config.flushInterval;this._interval=setInterval(this._sendBatch,e)},e.prototype._sendBatch=function(){var e=this._buffer.length;if(this._flush&&!e&&clearInterval(this._interval),!this._pause&&e){var t=this._config.flushSize,n=Math.min(t,e),r=this._buffer.splice(0,n);this._putEvents(r)}},e.prototype._putEvents=function(e){return Ee(this,void 0,void 0,(function(){var t,n,r,i,o;return Se(this,(function(s){switch(s.label){case 0:t=this._bufferToMap(e),n=this._generateBatchEventParams(t),s.label=1;case 1:return s.trys.push([1,3,,4]),r=new Y(n),[4,this._client.send(r)];case 2:return i=s.sent(),this._processPutEventsSuccessResponse(i,t),[3,4];case 3:return o=s.sent(),[2,this._handlePutEventsFailure(o,t)];case 4:return[2]}}))}))},e.prototype._generateBatchEventParams=function(e){var t={ApplicationId:"",EventsRequest:{BatchItem:{}}};return Object.values(e).forEach((function(e){var n=e.params,r=n.event,i=n.timestamp,o=n.config,s=r.name,a=r.attributes,u=r.metrics,c=r.eventId,d=r.session,l=o.appId,f=o.endpointId,p=t.EventsRequest.BatchItem;t.ApplicationId=t.ApplicationId||l,p[f]||(p[f]={Endpoint:{},Events:{}}),p[f].Events[c]={EventType:s,Timestamp:new Date(i).toISOString(),Attributes:a,Metrics:u,Session:d}})),t},e.prototype._handlePutEventsFailure=function(e,t){xe.debug("_putEvents Failed: ",e);var n=e.$metadata&&e.$metadata.httpStatusCode;if(Ie.includes(n)){var r=Object.values(t);this._retry(r)}else;},e.prototype._processPutEventsSuccessResponse=function(e,t){var n=e.EventsResponse.Results,r=[];Object.entries(n).forEach((function(e){var n=je(e,2),i=n[0],o=n[1].EventsItemResponse;Object.entries(o).forEach((function(e){var n,o,s=je(e,2),a=s[0],u=s[1],c=u.StatusCode,d=u.Message,l=t[a],f={EventsResponse:{Results:(n={},n[i]={EventsItemResponse:(o={},o[a]={StatusCode:c,Message:d},o)},n)}};if(Pe.includes(c))l.handlers.resolve(f);else{if(!Ie.includes(c)){var p=l.params.event.name;return xe.error("event "+a+" : "+p+" failed with error: "+d),l.handlers.reject(f)}r.push(l)}}))})),r.length&&this._retry(r)},e.prototype._retry=function(e){var t,n=[];e.forEach((function(e){var t,r=e.params,i=r.event,o=i.eventId,s=i.name;if(r.resendLimit-- >0)return xe.debug("resending event "+o+" : "+s+" with "+r.resendLimit+" retry attempts remaining"),void n.push((t={},t[o]=e,t));xe.debug("no retry attempts remaining for event "+o+" : "+s)})),(t=this._buffer).unshift.apply(t,Ae(n))},e.prototype._bufferToMap=function(e){return e.reduce((function(e,t){var n=je(Object.entries(t),1),r=je(n[0],2),i=r[0],o=r[1];return e[i]=o,e}),{})},e}();function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ce=function(){return(Ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Re=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},ke=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ue=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},De="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",ze=function(e,t){r.Hub.dispatch("analytics",{event:e,data:t},"Analytics",De)},Le=new r.ConsoleLogger("AWSPinpointProvider"),Ne=[429,500],qe=[202],He="undefined"!=typeof navigator&&navigator&&"function"==typeof navigator.sendBeacon,Be=function(){function e(e){this._endpointGenerating=!0,this._endpointUpdateInProgress=!1,this._buffer=null,this._endpointBuffer=[],this._config=e||{},this._config.bufferSize=this._config.bufferSize||1e3,this._config.flushSize=this._config.flushSize||100,this._config.flushInterval=this._config.flushInterval||5e3,this._config.resendLimit=this._config.resendLimit||5,this._clientInfo=r.ClientDevice.clientInfo()}return e.prototype.getCategory=function(){return e.category},e.prototype.getProviderName=function(){return e.providerName},e.prototype.configure=function(e){var t=this;Le.debug("configure Analytics",e);var n=e||{};if(this._config=Object.assign({},this._config,n),this._config.appId&&!this._config.disabled)if(this._config.endpointId)ze("pinpointProvider_configured",null);else{var r=this.getProviderName()+"_"+this._config.appId;this._getEndpointId(r).then((function(e){Le.debug("setting endpoint id from the cache",e),t._config.endpointId=e,ze("pinpointProvider_configured",null)})).catch((function(e){Le.debug("Failed to generate endpointId",e)}))}else this._flushBuffer();return this._config},e.prototype.record=function(e,t){return Re(this,void 0,void 0,(function(){var n,r;return ke(this,(function(i){switch(i.label){case 0:return Le.debug("_public record",e),[4,this._getCredentials()];case 1:return(n=i.sent())&&this._config.appId&&this._config.region?(this._initClients(n),r=(new Date).getTime(),this._generateSession(e),e.event.eventId=Object(Oe.v1)(),Object.assign(e,{timestamp:r,config:this._config}),e.event.immediate?[2,this._send(e,t)]:(this._putToBuffer(e,t),[2])):(Le.debug("cannot send events without credentials, applicationId or region"),[2,t.reject(new Error("No credentials, applicationId or region"))])}}))}))},e.prototype._sendEndpointUpdate=function(e){return Re(this,void 0,void 0,(function(){var t;return ke(this,(function(n){switch(n.label){case 0:return this._endpointUpdateInProgress?(this._endpointBuffer.push(e),[2]):(this._endpointUpdateInProgress=!0,[4,this._updateEndpoint(e)]);case 1:return n.sent(),t=this._endpointBuffer.shift(),this._endpointUpdateInProgress=!1,t&&this._sendEndpointUpdate(t),[2]}}))}))},e.prototype._putToBuffer=function(e,t){"_update_endpoint"!==e.event.name?this._buffer&&this._buffer.push({params:e,handlers:t}):this._sendEndpointUpdate({params:e,handlers:t})},e.prototype._generateSession=function(e){this._sessionId=this._sessionId||Object(Oe.v1)();var t=e.event;switch(t.name){case"_session.start":this._sessionStartTimestamp=(new Date).getTime(),this._sessionId=Object(Oe.v1)(),t.session={Id:this._sessionId,StartTimestamp:new Date(this._sessionStartTimestamp).toISOString()};break;case"_session.stop":var n=(new Date).getTime();this._sessionStartTimestamp=this._sessionStartTimestamp||(new Date).getTime(),this._sessionId=this._sessionId||Object(Oe.v1)(),t.session={Id:this._sessionId,Duration:n-this._sessionStartTimestamp,StartTimestamp:new Date(this._sessionStartTimestamp).toISOString(),StopTimestamp:new Date(n).toISOString()},this._sessionId=void 0,this._sessionStartTimestamp=void 0;break;default:this._sessionStartTimestamp=this._sessionStartTimestamp||(new Date).getTime(),this._sessionId=this._sessionId||Object(Oe.v1)(),t.session={Id:this._sessionId,StartTimestamp:new Date(this._sessionStartTimestamp).toISOString()}}},e.prototype._send=function(e,t){return Re(this,void 0,void 0,(function(){return ke(this,(function(n){switch(e.event.name){case"_update_endpoint":return[2,this._updateEndpoint({params:e,handlers:t})];case"_session.stop":return[2,this._pinpointSendStopSession(e,t)];default:return[2,this._pinpointPutEvents(e,t)]}return[2]}))}))},e.prototype._generateBatchItemContext=function(e){var t,n=e.event,r=e.timestamp,i=e.config,o=n.name,s=n.attributes,a=n.metrics,u=n.eventId,c=n.session,d=i.appId,l=i.endpointId,f={ApplicationId:d,EventsRequest:{BatchItem:{}}},p={Endpoint:{}};return p.Events=((t={})[u]={EventType:o,Timestamp:new Date(r).toISOString(),Attributes:s,Metrics:a,Session:c},t),f.EventsRequest.BatchItem[l]=p,f},e.prototype._pinpointPutEvents=function(e,t){return Re(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,d,l,f;return ke(this,(function(p){switch(p.label){case 0:n=e.event.eventId,r=e.config.endpointId,i=this._generateBatchItemContext(e),o=new Y(i),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.pinpointClient.send(o)];case 2:return s=p.sent(),a=r,u=n,c=s.EventsResponse.Results[a].EventsItemResponse[u],d=c.StatusCode,l=c.Message,qe.includes(d)?(Le.debug("record event success. ",s),[2,t.resolve(s)]):Ne.includes(d)?(this._retry(e,t),[3,4]):(Le.error("Event "+n+" is not accepted, the error is "+l),[2,t.reject(s)]);case 3:return f=p.sent(),this._eventError(f),[2,t.reject(f)];case 4:return[2]}}))}))},e.prototype._pinpointSendStopSession=function(e,t){if(He){var n=this._generateBatchItemContext(e),i=this._config.region,o=n.ApplicationId,s=n.EventsRequest,a={secret_key:this._config.credentials.secretAccessKey,access_key:this._config.credentials.accessKeyId,session_token:this._config.credentials.sessionToken},u="https://pinpoint."+i+".amazonaws.com/v1/apps/"+o+"/events/legacy",c=JSON.stringify(s),d={url:u,body:c,method:"POST"},l={region:i,service:"mobiletargeting"},f=r.Signer.signUrl(d,a,l,null);return navigator.sendBeacon(f,c)?t.resolve("sendBeacon success"):t.reject("sendBeacon failure")}this._pinpointPutEvents(e,t)},e.prototype._retry=function(e,t){var n=e.config.resendLimit;e.resendLimit="number"==typeof e.resendLimit?e.resendLimit:n,e.resendLimit-- >0?(Le.debug("resending event "+e.eventName+" with "+e.resendLimit+" retry times left"),this._pinpointPutEvents(e,t)):Le.debug("retry times used up for event "+e.eventName)},e.prototype._updateEndpoint=function(e){return Re(this,void 0,void 0,(function(){var t,n,i,o,s,a,u,c,d,l,f,p;return ke(this,(function(h){switch(h.label){case 0:t=e.params,n=e.handlers,i=t.config,o=t.event,s=i.appId,a=i.endpointId,u=this._endpointRequest(i,r.JS.transferKeyToLowerCase(o,[],["attributes","userAttributes","Attributes","UserAttributes"])),c={ApplicationId:s,EndpointId:a,EndpointRequest:u},h.label=1;case 1:return h.trys.push([1,3,,4]),d=new G(c),[4,this.pinpointClient.send(d)];case 2:return l=h.sent(),Le.debug("updateEndpoint success",l),this._endpointGenerating=!1,this._resumeBuffer(),n.resolve(l),[2];case 3:return f=h.sent(),p={err:f,update_params:c,endpointObject:e},[2,this._handleEndpointUpdateFailure(p)];case 4:return[2]}}))}))},e.prototype._handleEndpointUpdateFailure=function(e){return Re(this,void 0,void 0,(function(){var t,n,r;return ke(this,(function(i){switch(t=e.err,n=e.endpointObject,r=t.$metadata&&t.$metadata.httpStatusCode,Le.debug("updateEndpoint failed",t),r){case 400:return[2,this._handleEndpointUpdateBadRequest(e)];case 403:return[2,this._handleEndpointUpdateForbidden(e)];default:if(Ne.includes(r))return!0,[2,this._retryEndpointUpdate(n,!0)];n.handlers.reject(t)}return[2]}))}))},e.prototype._handleEndpointUpdateBadRequest=function(e){return Re(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return ke(this,(function(u){switch(u.label){case 0:if(t=e.err,n=e.update_params,r=e.endpointObject,i=t.message,o=n.ApplicationId,s=n.EndpointRequest,!String(i).startsWith("Exceeded maximum endpoint per user count"))return[2,r.handlers.reject(t)];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this._removeUnusedEndpoints(o,s.User.UserId)];case 2:return u.sent(),Le.debug("Removed unused endpoints successfully"),this._retryEndpointUpdate(r),[3,4];case 3:return a=u.sent(),Le.warn("Failed to remove unused endpoints with error: "+a),Le.warn('Please ensure you have updated your Pinpoint IAM Policy with the Action: "mobiletargeting:GetUserEndpoints" in order to get endpoints info of the user'),[2,r.handlers.reject(a)];case 4:return[2]}}))}))},e.prototype._handleEndpointUpdateForbidden=function(e){var t=e.err,n=e.endpointObject,r=t.code,i=t.retryable;if("ExpiredTokenException"!==r&&!i)return n.handlers.reject(t);this._retryEndpointUpdate(n)},e.prototype._retryEndpointUpdate=function(e,t){void 0===t&&(t=!1),Le.debug("_retryEndpointUpdate",e);var n=e.params,r=n.config.resendLimit;if(n.resendLimit="number"==typeof n.resendLimit?n.resendLimit:r,n.resendLimit-- >0)return Le.debug("resending endpoint update "+n.event.eventId+" with "+n.resendLimit+" retry attempts remaining"),void(this._endpointBuffer.length?this._endpointBuffer.unshift(e):this._updateEndpoint(e));Le.warn("resending endpoint update "+n.event.eventId+" failed after "+n.config.resendLimit+" attempts"),this._endpointGenerating&&Le.error("Initial endpoint update failed. ")},e.prototype._removeUnusedEndpoints=function(e,t){return Re(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,d,l,f,p;return ke(this,(function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),n=new J({ApplicationId:e,UserId:t}),[4,this.pinpointClient.send(n)];case 1:for(r=h.sent(),i=r.EndpointsResponse.Item,Le.debug("get endpoints associated with the userId: "+t+" with data",i),o=i[0],s=1;s<i.length&&(a=Date.parse(o.EffectiveDate),u=Date.parse(i[s].EffectiveDate),!isNaN(a));s++){if(isNaN(u)){o=i[s];break}u<a&&(o=i[s])}c={ApplicationId:e,EndpointId:o.Id,EndpointRequest:{User:{UserId:""}}},h.label=2;case 2:return h.trys.push([2,4,,5]),d=new G(c),[4,this.pinpointClient.send(d)];case 3:return l=h.sent(),Le.debug("The old endpoint is updated with an empty string for user id"),[2,l];case 4:throw f=h.sent(),Le.debug("Failed to update the endpoint",f),f;case 5:return[3,7];case 6:throw p=h.sent(),Le.debug("Failed to get endpoints associated with the userId: "+t+" with error",p),p;case 7:return[2]}}))}))},e.prototype._initClients=function(e){return Re(this,void 0,void 0,(function(){var t,n;return ke(this,(function(i){return Le.debug("init clients"),this.pinpointClient&&this._config.credentials&&this._config.credentials.sessionToken===e.sessionToken&&this._config.credentials.identityId===e.identityId?(Le.debug("no change for aws credentials, directly return from init"),[2]):(t=this._config.credentials?this._config.credentials.identityId:null,this._config.credentials=e,n=this._config.region,Le.debug("init clients with credentials",e),this.pinpointClient=new me({region:n,credentials:e,customUserAgent:Object(r.getAmplifyUserAgent)()}),this.pinpointClient.middlewareStack.addRelativeTo((function(e){return function(t){return delete t.request.headers["amz-sdk-invocation-id"],delete t.request.headers["amz-sdk-request"],e(t)}}),{step:"finalizeRequest",relation:"after",toMiddleware:"retryMiddleware"}),this._bufferExists()&&t===e.identityId?this._updateBufferClient():this._initBuffer(),this._customizePinpointClientReq(),[2])}))}))},e.prototype._bufferExists=function(){return this._buffer&&this._buffer instanceof Me},e.prototype._initBuffer=function(){this._bufferExists()&&this._flushBuffer(),this._buffer=new Me(this.pinpointClient,this._config),this._endpointGenerating&&this._buffer.pause()},e.prototype._updateBufferClient=function(){this._bufferExists()&&this._buffer.updateClient(this.pinpointClient)},e.prototype._flushBuffer=function(){this._bufferExists()&&(this._buffer.flush(),this._buffer=null)},e.prototype._resumeBuffer=function(){this._bufferExists()&&this._buffer.resume()},e.prototype._customizePinpointClientReq=function(){},e.prototype._getEndpointId=function(e){return Re(this,void 0,void 0,(function(){var t;return ke(this,(function(n){switch(n.label){case 0:return[4,we.a.getItem(e)];case 1:return t=n.sent(),Le.debug("endpointId from cache",t,"type",Te(t)),t||(t=Object(Oe.v1)(),we.a.setItem(e,t)),[2,t]}}))}))},e.prototype._endpointRequest=function(e,t){var n=e.credentials,i=this._clientInfo||{},o=e.clientContext||{},s=e.endpoint||{},a={appVersion:i.appVersion,make:i.make,model:i.model,modelVersion:i.version,platform:i.platform},u=(o.clientId,o.appTitle,o.appVersionName,o.appVersionCode,o.appPackageName,Ue(o,["clientId","appTitle","appVersionName","appVersionCode","appPackageName"])),c=t.address?"android"===i.platform?"GCM":"APNS":void 0,d=Ce(Ce(Ce({channelType:c,requestId:Object(Oe.v1)(),effectiveDate:(new Date).toISOString()},s),t),{attributes:Ce(Ce({},s.attributes),t.attributes),demographic:Ce(Ce(Ce(Ce({},a),u),s.demographic),t.demographic),location:Ce(Ce({},s.location),t.location),metrics:Ce(Ce({},s.metrics),t.metrics),user:{userId:t.userId||s.userId||n.identityId,userAttributes:Ce(Ce({},s.userAttributes),t.userAttributes)}}),l=(d.userId,d.userAttributes,d.name,d.session,d.eventId,d.immediate,Ue(d,["userId","userAttributes","name","session","eventId","immediate"]));return r.JS.transferKeyToUpperCase(l,[],["metrics","userAttributes","attributes"])},e.prototype._eventError=function(e){Le.error("record event failed.",e),Le.warn('Please ensure you have updated your Pinpoint IAM Policy with the Action: "mobiletargeting:PutEvents" in order to record events')},e.prototype._getCredentials=function(){return Re(this,void 0,void 0,(function(){var e,t;return ke(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r.Credentials.get()];case 1:return(e=n.sent())?(Le.debug("set credentials for analytics",e),[2,r.Credentials.shear(e)]):[2,null];case 2:return t=n.sent(),Le.debug("ensure credentials error",t),[2,null];case 3:return[2]}}))}))},e.category="Analytics",e.providerName="AWSPinpoint",e}(),Fe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},$e=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Fe(arguments[t]));return e},Ve=[],Ke=function(){function e(e,t){this.context=e,this.methodName=t,this._originalMethod=e[t].bind(e)}return e.add=function(e,t,n){We(e,t).set(n)},e.remove=function(e,t){We(e,t).remove()},e.prototype.set=function(e){var t=this;this.context[this.methodName]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t._originalMethod.apply(t,$e(n)))}},e.prototype.remove=function(){this.context[this.methodName]=this._originalMethod},e}();function We(e,t){var n=Ve.filter((function(n){return n.context===e&&n.methodName===t}))[0];return n||(n=new Ke(e,t),Ve.push(n)),n}var Ye=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Ge=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Je=new r.ConsoleLogger("PageViewTracker"),Ze="aws-amplify-analytics-prevUrl",Xe={enable:!1,provider:"AWSPinpoint",getUrl:function(){return r.JS.browserOrNode().isBrowser?window.location.origin+window.location.pathname:""}},Qe=function(){function e(e,t){Je.debug("initialize pageview tracker with opts",t),this._config=Object.assign({},Xe,t),this._tracker=e,this._hasEnabled=!1,this._trackFunc=this._trackFunc.bind(this),"SPA"===this._config.type?this._pageViewTrackSPA():this._pageViewTrackDefault()}return e.prototype.configure=function(e){return Object.assign(this._config,e),"SPA"===this._config.type&&this._pageViewTrackSPA(),this._config},e.prototype._isSameUrl=function(){return sessionStorage.getItem(Ze)===this._config.getUrl()&&(Je.debug("the url is same"),!0)},e.prototype._pageViewTrackDefault=function(){return Ye(this,void 0,void 0,(function(){var e,t,n,i;return Ge(this,(function(o){switch(o.label){case 0:return r.JS.browserOrNode().isBrowser&&window.addEventListener&&window.sessionStorage?(e=this._config.getUrl(),"function"!=typeof this._config.attributes?[3,2]:[4,this._config.attributes()]):(Je.debug("not in the supported web enviroment"),[2]);case 1:return n=o.sent(),[3,3];case 2:n=this._config.attributes,o.label=3;case 3:return t=n,i=Object.assign({url:e},t),this._config.enable&&!this._isSameUrl()&&(this._tracker({name:this._config.eventName||"pageView",attributes:i},this._config.provider).catch((function(e){Je.debug("Failed to record the page view event",e)})),sessionStorage.setItem(Ze,e)),[2]}}))}))},e.prototype._trackFunc=function(){return Ye(this,void 0,void 0,(function(){var e,t,n,i;return Ge(this,(function(o){switch(o.label){case 0:return r.JS.browserOrNode().isBrowser&&window.addEventListener&&history.pushState&&window.sessionStorage?(e=this._config.getUrl(),"function"!=typeof this._config.attributes?[3,2]:[4,this._config.attributes()]):(Je.debug("not in the supported web enviroment"),[2]);case 1:return n=o.sent(),[3,3];case 2:n=this._config.attributes,o.label=3;case 3:return t=n,i=Object.assign({url:e},t),this._isSameUrl()||(this._tracker({name:this._config.eventName||"pageView",attributes:i},this._config.provider).catch((function(e){Je.debug("Failed to record the page view event",e)})),sessionStorage.setItem(Ze,e)),[2]}}))}))},e.prototype._pageViewTrackSPA=function(){r.JS.browserOrNode().isBrowser&&window.addEventListener&&history.pushState?this._config.enable&&!this._hasEnabled?(Ke.add(history,"pushState",this._trackFunc),Ke.add(history,"replaceState",this._trackFunc),window.addEventListener("popstate",this._trackFunc),this._trackFunc(),this._hasEnabled=!0):(Ke.remove(history,"pushState"),Ke.remove(history,"replaceState"),window.removeEventListener("popstate",this._trackFunc),this._hasEnabled=!1):Je.debug("not in the supported web enviroment")},e}(),et=r.JS.browserOrNode().isBrowser&&window.Element?window.Element.prototype:null,tt=et?et.matches||et.matchesSelector||et.webkitMatchesSelector||et.mozMatchesSelector||et.msMatchesSelector||et.oMatchesSelector:null;function nt(e,t){if(e&&1===e.nodeType&&t){if("string"==typeof t||1===t.nodeType)return e===t||rt(e,t);if("length"in t)for(var n=0,r=void 0;r=t[n];n++)if(e===r||rt(e,r))return!0}return!1}function rt(e,t){if("string"!=typeof t)return!1;if(tt)return tt.call(e,t);for(var n=e.parentNode.querySelectorAll(t),r=0,i=void 0;i=n[r];r++)if(i===e)return!0;return!1}function it(e,t,n,r,i){void 0===i&&(i={});var o=function(e){var t;if(i.composed&&"function"==typeof e.composedPath)for(var o=e.composedPath(),s=0,a=void 0;a=o[s];s++)1===a.nodeType&&nt(a,n)&&(t=a);else t=function(e,t,n){if(void 0===n&&(n=!1),e&&1===e.nodeType&&t)for(var r,i=(n?[e]:[]).concat(function(e){for(var t=[],n=e;n&&n.parentNode&&1===n.parentNode.nodeType;)n=n.parentNode,t.push(n);return t}(e)),o=0;r=i[o];o++)if(nt(r,t))return r}(e.target,n,!0);t&&r.call(t,e,t)};return e.addEventListener(t,o,i.useCapture),{destroy:function(){e.removeEventListener(t,o,i.useCapture)}}}var ot=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},st=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},at=new r.ConsoleLogger("EventTracker"),ut={enable:!1,events:["click"],selectorPrefix:"data-amplify-analytics-",provider:"AWSPinpoint"},ct=function(){function e(e,t){r.JS.browserOrNode().isBrowser&&window.addEventListener?(this._config=Object.assign({},ut,t),this._tracker=e,this._delegates={},this._trackFunc=this._trackFunc.bind(this),at.debug("initialize pageview tracker with opts",this._config),this.configure(this._config)):at.debug("not in the supported web environment")}return e.prototype.configure=function(e){var t=this;if(Object.assign(this._config,e),this._config.enable){if(this._config.enable&&0===Object.keys(this._delegates).length){var n="["+this._config.selectorPrefix+"on]";this._config.events.forEach((function(e){t._delegates[e]=it(document,e,n,t._trackFunc,{composed:!0,useCapture:!0})}))}}else Object.keys(this._delegates).forEach((function(e){"function"==typeof t._delegates[e].destroy&&t._delegates[e].destroy()})),this._delegates={};return this._config},e.prototype._trackFunc=function(e,t){return ot(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return st(this,(function(c){switch(c.label){case 0:return n={},r=t.getAttribute(this._config.selectorPrefix+"on").split(/\s*,\s*/),i=t.getAttribute(this._config.selectorPrefix+"name"),(o=t.getAttribute(this._config.selectorPrefix+"attrs"))&&o.split(/\s*,\s*/).forEach((function(e){var t=e.trim().split(/\s*:\s*/);n[t[0]]=t[1]})),"function"!=typeof this._config.attributes?[3,2]:[4,this._config.attributes()];case 1:return a=c.sent(),[3,3];case 2:a=this._config.attributes,c.label=3;case 3:return s=a,u=Object.assign({type:e.type,target:e.target.localName+" with id "+e.target.id},s,n),at.debug("events needed to be recorded",r),at.debug("attributes needed to be attached",n),r.indexOf(e.type)<0?(at.debug("event "+e.type+" is not selected to be recorded"),[2]):(this._tracker({name:i||"event",attributes:u},this._config.provider).catch((function(t){at.debug("Failed to record the "+e.type+" event', "+t)})),[2])}}))}))},e}(),dt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},lt=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ft=new r.ConsoleLogger("SessionTracker"),pt={enable:!1,provider:"AWSPinpoint"},ht=!1,vt=function(){function e(e,t){this._config=Object.assign({},pt,t),this._tracker=e,this._hasEnabled=!1,this._trackFunc=this._trackFunc.bind(this),this._trackBeforeUnload=this._trackBeforeUnload.bind(this),this.configure(this._config)}return e.prototype._envCheck=function(){if(!r.JS.browserOrNode().isBrowser)return!1;if(!document||!document.addEventListener)return ft.debug("not in the supported web environment"),!1;if(void 0!==document.hidden)this._hidden="hidden",this._visibilityChange="visibilitychange";else if(void 0!==document.msHidden)this._hidden="msHidden",this._visibilityChange="msvisibilitychange";else{if(void 0===document.webkitHidden)return ft.debug("not in the supported web environment"),!1;this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange"}return!0},e.prototype._trackFunc=function(){return dt(this,void 0,void 0,(function(){var e,t,n;return lt(this,(function(r){switch(r.label){case 0:return"function"!=typeof this._config.attributes?[3,2]:[4,this._config.attributes()];case 1:return t=r.sent(),[3,3];case 2:t=this._config.attributes,r.label=3;case 3:return e=t,n=Object.assign({},e),document.visibilityState===this._hidden?this._tracker({name:"_session.stop",attributes:n},this._config.provider).catch((function(e){ft.debug("record session stop event failed.",e)})):this._tracker({name:"_session.start",attributes:n},this._config.provider).catch((function(e){ft.debug("record session start event failed.",e)})),[2]}}))}))},e.prototype._trackBeforeUnload=function(e){var t=this;("function"==typeof this._config.attributes?Promise.resolve(this._config.attributes()):Promise.resolve(this._config.attributes)).then((function(e){var n=Object.assign({},e);t._tracker({name:"_session.stop",attributes:n,immediate:!0},t._config.provider).catch((function(e){ft.debug("record session stop event failed.",e)}))}))},e.prototype._sendInitialEvent=function(){return dt(this,void 0,void 0,(function(){var e,t,n;return lt(this,(function(r){switch(r.label){case 0:return ht?(ft.debug("the start session has been sent when the page is loaded"),[2]):(ht=!0,"function"!=typeof this._config.attributes?[3,2]:[4,this._config.attributes()]);case 1:return t=r.sent(),[3,3];case 2:t=this._config.attributes,r.label=3;case 3:return e=t,n=Object.assign({},e),this._tracker({name:"_session.start",attributes:n},this._config.provider).catch((function(e){ft.debug("record session start event failed.",e)})),[2]}}))}))},e.prototype.configure=function(e){return this._envCheck()?(Object.assign(this._config,e),this._config.enable&&!this._hasEnabled?(this._sendInitialEvent(),document.addEventListener(this._visibilityChange,this._trackFunc,!1),window.addEventListener("beforeunload",this._trackBeforeUnload,!1),this._hasEnabled=!0):!this._config.enable&&this._hasEnabled&&(document.removeEventListener(this._visibilityChange,this._trackFunc,!1),window.removeEventListener("beforeunload",this._trackBeforeUnload,!1),this._hasEnabled=!1),this._config):this._config},e}(),_t=function(){return(_t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},gt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},yt=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},mt=new r.ConsoleLogger("AnalyticsClass"),bt="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",wt={pageView:Qe,event:ct,session:vt},Ot=null,Et=function(){function e(){this._config={},this._pluggables=[],this._disabled=!1,this._trackers={},Ot=this,this.record=this.record.bind(this),r.Hub.listen("auth",xt),r.Hub.listen("storage",xt),r.Hub.listen("analytics",xt)}return e.prototype.getModuleName=function(){return"Analytics"},e.prototype.configure=function(e){var t=this;if(!e)return this._config;mt.debug("configure Analytics",e);var n,i,o,s=r.Parser.parseMobilehubConfig(e);return this._config=Object.assign({},this._config,s.Analytics,e),this._config.disabled&&(this._disabled=!0),this._pluggables.forEach((function(e){var n="AWSPinpoint"!==e.getProviderName()||t._config.AWSPinpoint?t._config[e.getProviderName()]:t._config;e.configure(_t({disabled:t._config.disabled},n))})),0===this._pluggables.length&&this.addPluggable(new Be),void 0===this._config.autoSessionRecord&&(this._config.autoSessionRecord=!0),n="configured",i=null,o="The Analytics category has been configured successfully",r.Hub.dispatch("analytics",{event:n,data:i,message:o},"Analytics",bt),mt.debug("current configuration",this._config),this._config},e.prototype.addPluggable=function(e){if(e&&"Analytics"===e.getCategory()){this._pluggables.push(e);var t="AWSPinpoint"!==e.getProviderName()||this._config.AWSPinpoint?this._config[e.getProviderName()]:this._config,n=_t({disabled:this._config.disabled},t);return e.configure(n),n}},e.prototype.getPluggable=function(e){for(var t=0;t<this._pluggables.length;t+=1){var n=this._pluggables[t];if(n.getProviderName()===e)return n}return mt.debug("No plugin found with providerName",e),null},e.prototype.removePluggable=function(e){for(var t=0;t<this._pluggables.length&&this._pluggables[t].getProviderName()!==e;)t+=1;return t===this._pluggables.length?void mt.debug("No plugin found with providerName",e):void this._pluggables.splice(t,t+1)},e.prototype.disable=function(){this._disabled=!0},e.prototype.enable=function(){this._disabled=!1},e.prototype.startSession=function(e){return gt(this,void 0,void 0,(function(){var t;return yt(this,(function(n){return t={event:{name:"_session.start"},provider:e},[2,this._sendEvent(t)]}))}))},e.prototype.stopSession=function(e){return gt(this,void 0,void 0,(function(){var t;return yt(this,(function(n){return t={event:{name:"_session.stop"},provider:e},[2,this._sendEvent(t)]}))}))},e.prototype.record=function(e,t,n){return gt(this,void 0,void 0,(function(){var r;return yt(this,(function(i){return r=null,r="string"==typeof e?{event:{name:e,attributes:t,metrics:n},provider:"AWSPinpoint"}:{event:e,provider:t},[2,this._sendEvent(r)]}))}))},e.prototype.updateEndpoint=function(e,t){return gt(this,void 0,void 0,(function(){var n;return yt(this,(function(r){return n=_t(_t({},e),{name:"_update_endpoint"}),[2,this.record(n,t)]}))}))},e.prototype._sendEvent=function(e){var t=this;if(this._disabled)return mt.debug("Analytics has been disabled"),Promise.resolve();var n=e.provider?e.provider:"AWSPinpoint";return new Promise((function(r,i){t._pluggables.forEach((function(t){t.getProviderName()===n&&t.record(e,{resolve:r,reject:i})}))}))},e.prototype.autoTrack=function(e,t){if(wt[e]){"session"===e&&(this._config.autoSessionRecord=t.enable);var n=this._trackers[e];n?n.configure(t):this._trackers[e]=new wt[e](this.record,t)}else mt.debug("invalid tracker type")},e}(),St=!1,jt=!1,At=!1,xt=function(e){var t=e.channel,n=e.payload;switch(mt.debug("on hub capsule "+t,n),t){case"auth":Pt(n);break;case"storage":It(n);break;case"analytics":Mt(n)}},It=function(e){var t=e.data,n=t.attrs,r=t.metrics;n&&At&&Ot.record({name:"Storage",attributes:n,metrics:r}).catch((function(e){mt.debug("Failed to send the storage event automatically",e)}))},Pt=function(e){var t=e.event;if(t){var n=function(e){return gt(void 0,void 0,void 0,(function(){var t;return yt(this,(function(n){switch(n.label){case 0:if(!jt||!At)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Ot.record({name:"_userauth."+e})];case 2:return[2,n.sent()];case 3:return t=n.sent(),mt.debug("Failed to send the "+e+" event automatically",t),[3,4];case 4:return[2]}}))}))};switch(t){case"signIn":return n("sign_in");case"signUp":return n("sign_up");case"signOut":return n("sign_out");case"signIn_failure":return n("auth_fail");case"configured":(jt=!0)&&At&&Tt()}}},Mt=function(e){var t=e.event;if(t)switch(t){case"pinpointProvider_configured":At=!0,jt&&At&&Tt()}},Tt=function(){var e=Ot.configure();!St&&e.autoSessionRecord&&(Ot.updateEndpoint({immediate:!0}).catch((function(e){mt.debug("Failed to update the endpoint",e)})),St=!0),Ot.autoTrack("session",{enable:e.autoSessionRecord})},Ct=new Et;r.Amplify.register(Ct);var Rt,kt,Ut,Dt,zt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,d,l,f,p,h,v,_,g,y,m;return Object(i.__generator)(this,(function(b){switch(b.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,dn(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=b.sent(),o)])),a="UnknownError",u=n.body.__type.split("#"),a=void 0===u[1]?u[0]:u[1],a){case"InvalidArgumentException":case"com.amazonaws.kinesis#InvalidArgumentException":return[3,2];case"KMSAccessDeniedException":case"com.amazonaws.kinesis#KMSAccessDeniedException":return[3,4];case"KMSDisabledException":case"com.amazonaws.kinesis#KMSDisabledException":return[3,6];case"KMSInvalidStateException":case"com.amazonaws.kinesis#KMSInvalidStateException":return[3,8];case"KMSNotFoundException":case"com.amazonaws.kinesis#KMSNotFoundException":return[3,10];case"KMSOptInRequired":case"com.amazonaws.kinesis#KMSOptInRequired":return[3,12];case"KMSThrottlingException":case"com.amazonaws.kinesis#KMSThrottlingException":return[3,14];case"ProvisionedThroughputExceededException":case"com.amazonaws.kinesis#ProvisionedThroughputExceededException":return[3,16];case"ResourceNotFoundException":case"com.amazonaws.kinesis#ResourceNotFoundException":return[3,18]}return[3,20];case 2:return c=[{}],[4,Lt(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,c.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 4:return d=[{}],[4,Nt(n,t)];case 5:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,d.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 6:return l=[{}],[4,qt(n,t)];case 7:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,l.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 8:return f=[{}],[4,Ht(n,t)];case 9:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,f.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 10:return p=[{}],[4,Bt(n,t)];case 11:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,p.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 12:return h=[{}],[4,Ft(n,t)];case 13:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,h.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 14:return v=[{}],[4,$t(n,t)];case 15:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,v.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 16:return _=[{}],[4,Vt(n,t)];case 17:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,_.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 18:return g=[{}],[4,Kt(n,t)];case 19:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,g.concat([b.sent()])),{name:a,$metadata:an(e)}]),[3,21];case 20:y=n.body,a=y.code||y.Code||a,s=Object(i.__assign)(Object(i.__assign)({},y),{name:""+a,message:y.message||y.Message||a,$fault:"client",$metadata:an(e)}),b.label=21;case 21:return m=s.message||s.Message||a,s.message=m,delete s.Message,[2,Promise.reject(Object.assign(new Error(m),s))]}}))}))},Lt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Gt(n,t),[2,Object(i.__assign)({name:"InvalidArgumentException",$fault:"client",$metadata:an(e)},r)]}))}))},Nt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Jt(n,t),[2,Object(i.__assign)({name:"KMSAccessDeniedException",$fault:"client",$metadata:an(e)},r)]}))}))},qt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Zt(n,t),[2,Object(i.__assign)({name:"KMSDisabledException",$fault:"client",$metadata:an(e)},r)]}))}))},Ht=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Xt(n,t),[2,Object(i.__assign)({name:"KMSInvalidStateException",$fault:"client",$metadata:an(e)},r)]}))}))},Bt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Qt(n,t),[2,Object(i.__assign)({name:"KMSNotFoundException",$fault:"client",$metadata:an(e)},r)]}))}))},Ft=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=en(n,t),[2,Object(i.__assign)({name:"KMSOptInRequired",$fault:"client",$metadata:an(e)},r)]}))}))},$t=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=tn(n,t),[2,Object(i.__assign)({name:"KMSThrottlingException",$fault:"client",$metadata:an(e)},r)]}))}))},Vt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=nn(n,t),[2,Object(i.__assign)({name:"ProvisionedThroughputExceededException",$fault:"client",$metadata:an(e)},r)]}))}))},Kt=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=sn(n,t),[2,Object(i.__assign)({name:"ResourceNotFoundException",$fault:"client",$metadata:an(e)},r)]}))}))},Wt=function(e,t){return Object(i.__assign)(Object(i.__assign)({},void 0!==e.Records&&{Records:Yt(e.Records,t)}),void 0!==e.StreamName&&{StreamName:e.StreamName})},Yt=function(e,t){return e.map((function(e){return function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.Data&&{Data:t.base64Encoder(e.Data)}),void 0!==e.ExplicitHashKey&&{ExplicitHashKey:e.ExplicitHashKey}),void 0!==e.PartitionKey&&{PartitionKey:e.PartitionKey})}(e,t)}))},Gt=function(e,t){return{__type:"InvalidArgumentException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Jt=function(e,t){return{__type:"KMSAccessDeniedException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Zt=function(e,t){return{__type:"KMSDisabledException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Xt=function(e,t){return{__type:"KMSInvalidStateException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Qt=function(e,t){return{__type:"KMSNotFoundException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},en=function(e,t){return{__type:"KMSOptInRequired",message:void 0!==e.message&&null!==e.message?e.message:void 0}},tn=function(e,t){return{__type:"KMSThrottlingException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},nn=function(e,t){return{__type:"ProvisionedThroughputExceededException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},rn=function(e,t){return{__type:"PutRecordsOutput",EncryptionType:void 0!==e.EncryptionType&&null!==e.EncryptionType?e.EncryptionType:void 0,FailedRecordCount:void 0!==e.FailedRecordCount&&null!==e.FailedRecordCount?e.FailedRecordCount:void 0,Records:void 0!==e.Records&&null!==e.Records?on(e.Records,t):void 0}},on=function(e,t){return(e||[]).map((function(e){return function(e,t){return{__type:"PutRecordsResultEntry",ErrorCode:void 0!==e.ErrorCode&&null!==e.ErrorCode?e.ErrorCode:void 0,ErrorMessage:void 0!==e.ErrorMessage&&null!==e.ErrorMessage?e.ErrorMessage:void 0,SequenceNumber:void 0!==e.SequenceNumber&&null!==e.SequenceNumber?e.SequenceNumber:void 0,ShardId:void 0!==e.ShardId&&null!==e.ShardId?e.ShardId:void 0}}(e)}))},sn=function(e,t){return{__type:"ResourceNotFoundException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},an=function(e){return{httpStatusCode:e.statusCode,httpHeaders:e.headers,requestId:e.headers["x-amzn-requestid"]}},un=function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)},cn=function(e,t,n,r,s){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var a,u,c,d,l,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.endpoint()];case 1:return a=i.sent(),u=a.hostname,c=a.protocol,d=void 0===c?"https":c,l=a.port,f={protocol:d,hostname:u,port:l,method:"POST",path:n,headers:t},void 0!==r&&(f.hostname=r),void 0!==s&&(f.body=s),[2,new o.HttpRequest(f)]}}))}))},dn=function(e,t){return function(e,t){return un(e,t).then((function(e){return t.utf8Encoder(e)}))}(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},ln=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){return n={"Content-Type":"application/x-amz-json-1.1","X-Amz-Target":"Kinesis_20131202.PutRecords"},r=JSON.stringify(Wt(e,t)),[2,cn(t,n,"/",void 0,r)]}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o;return Object(i.__generator)(this,(function(s){switch(s.label){case 0:return e.statusCode>=400?[2,zt(e,t)]:[4,dn(e.body,t)];case 1:return n=s.sent(),{},r=rn(n,t),o=Object(i.__assign)({$metadata:an(e),__type:"PutRecordsOutput"},r),[2,Promise.resolve(o)]}}))}))}(e,t)},t}(s.Command),fn=n(43),pn=n(83),hn=new Set(["ap-south-1","eu-north-1","eu-west-3","eu-west-2","eu-west-1","ap-northeast-2","ap-northeast-1","me-south-1","ca-central-1","sa-east-1","ap-east-1","ap-southeast-1","ap-southeast-2","eu-central-1","us-east-1","us-east-2","us-west-1","us-west-2"]),vn=new Set(["cn-north-1","cn-northwest-1"]),_n=new Set(["us-iso-east-1"]),gn=new Set(["us-isob-east-1"]),yn=new Set(["us-gov-west-1","us-gov-east-1"]),mn={apiVersion:"2013-12-02",disableHostPrefix:!1,regionInfoProvider:function(e,t){var n=void 0;switch(e){case"ap-east-1":n={hostname:"kinesis.ap-east-1.amazonaws.com"};break;case"ap-northeast-1":n={hostname:"kinesis.ap-northeast-1.amazonaws.com"};break;case"ap-northeast-2":n={hostname:"kinesis.ap-northeast-2.amazonaws.com"};break;case"ap-south-1":n={hostname:"kinesis.ap-south-1.amazonaws.com"};break;case"ap-southeast-1":n={hostname:"kinesis.ap-southeast-1.amazonaws.com"};break;case"ap-southeast-2":n={hostname:"kinesis.ap-southeast-2.amazonaws.com"};break;case"ca-central-1":n={hostname:"kinesis.ca-central-1.amazonaws.com"};break;case"cn-north-1":n={hostname:"kinesis.cn-north-1.amazonaws.com.cn"};break;case"cn-northwest-1":n={hostname:"kinesis.cn-northwest-1.amazonaws.com.cn"};break;case"eu-central-1":n={hostname:"kinesis.eu-central-1.amazonaws.com"};break;case"eu-north-1":n={hostname:"kinesis.eu-north-1.amazonaws.com"};break;case"eu-west-1":n={hostname:"kinesis.eu-west-1.amazonaws.com"};break;case"eu-west-2":n={hostname:"kinesis.eu-west-2.amazonaws.com"};break;case"eu-west-3":n={hostname:"kinesis.eu-west-3.amazonaws.com"};break;case"me-south-1":n={hostname:"kinesis.me-south-1.amazonaws.com"};break;case"sa-east-1":n={hostname:"kinesis.sa-east-1.amazonaws.com"};break;case"us-east-1":n={hostname:"kinesis.us-east-1.amazonaws.com"};break;case"us-east-2":n={hostname:"kinesis.us-east-2.amazonaws.com"};break;case"us-gov-east-1":n={hostname:"kinesis.us-gov-east-1.amazonaws.com"};break;case"us-gov-west-1":n={hostname:"kinesis.us-gov-west-1.amazonaws.com"};break;case"us-iso-east-1":n={hostname:"kinesis.us-iso-east-1.c2s.ic.gov"};break;case"us-isob-east-1":n={hostname:"kinesis.us-isob-east-1.sc2s.sgov.gov"};break;case"us-west-1":n={hostname:"kinesis.us-west-1.amazonaws.com"};break;case"us-west-2":n={hostname:"kinesis.us-west-2.amazonaws.com"};break;default:hn.has(e)&&(n={hostname:"kinesis.{region}.amazonaws.com".replace("{region}",e)}),vn.has(e)&&(n={hostname:"kinesis.{region}.amazonaws.com.cn".replace("{region}",e)}),_n.has(e)&&(n={hostname:"kinesis.{region}.c2s.ic.gov".replace("{region}",e)}),gn.has(e)&&(n={hostname:"kinesis.{region}.sc2s.sgov.gov".replace("{region}",e)}),yn.has(e)&&(n={hostname:"kinesis.{region}.amazonaws.com".replace("{region}",e)}),void 0===n&&(n={hostname:"kinesis.{region}.amazonaws.com".replace("{region}",e)})}return Promise.resolve(n)},signingName:"kinesis"},bn=Object(i.__assign)(Object(i.__assign)({},mn),{runtime:"browser",base64Decoder:ne.fromBase64,base64Encoder:ne.toBase64,bodyLengthChecker:re.calculateBodyLength,credentialDefaultProvider:Object(ee.invalidFunction)("Credential is missing"),defaultUserAgent:Object(ie.defaultUserAgent)(fn.a,fn.b),eventStreamSerdeProvider:pn.eventStreamSerdeProvider,maxAttemptsDefaultProvider:function(){return"3"},regionDefaultProvider:Object(ee.invalidFunction)("Region is missing"),requestHandler:new Q.FetchHttpHandler,sha256:X.Sha256,streamCollector:Q.streamCollector,urlParser:te.parseUrl,utf8Decoder:oe.fromUtf8,utf8Encoder:oe.toUtf8}),wn=n(82),On=function(e){function t(t){var n=this,r=Object(i.__assign)(Object(i.__assign)({},bn),t),o=Object(pe.resolveRegionConfig)(r),s=Object(pe.resolveEndpointsConfig)(o),a=Object(ge.resolveAwsAuthConfig)(s),u=Object(_e.resolveRetryConfig)(a),c=Object(ye.resolveUserAgentConfig)(u),d=Object(ve.resolveHostHeaderConfig)(c),l=Object(wn.resolveEventStreamSerdeConfig)(d);return(n=e.call(this,l)||this).config=l,n.middlewareStack.use(Object(ge.getAwsAuthPlugin)(n.config)),n.middlewareStack.use(Object(_e.getRetryPlugin)(n.config)),n.middlewareStack.use(Object(ye.getUserAgentPlugin)(n.config)),n.middlewareStack.use(Object(he.getContentLengthPlugin)(n.config)),n.middlewareStack.use(Object(ve.getHostHeaderPlugin)(n.config)),n}return Object(i.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(s.Client),En=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Sn=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},jn=new r.ConsoleLogger("AWSKinesisProvider"),An=function(){function e(e){this._buffer=[],this._config=e||{},this._config.bufferSize=this._config.bufferSize||1e3,this._config.flushSize=this._config.flushSize||100,this._config.flushInterval=this._config.flushInterval||5e3,this._config.resendLimit=this._config.resendLimit||5,this._setupTimer()}return e.prototype._setupTimer=function(){var e=this;this._timer&&clearInterval(this._timer);var t=this._config,n=t.flushSize,r=t.flushInterval;this._timer=setInterval((function(){for(var t=e._buffer.length<n?e._buffer.length:n,r=[],i=0;i<t;i+=1){var o=e._buffer.shift();r.push(o)}e._sendFromBuffer(r)}),r)},e.prototype.getCategory=function(){return"Analytics"},e.prototype.getProviderName=function(){return"AWSKinesis"},e.prototype.configure=function(e){jn.debug("configure Analytics",e);var t=e||{};return this._config=Object.assign({},this._config,t),this._setupTimer(),this._config},e.prototype.record=function(e){return En(this,void 0,void 0,(function(){var t;return Sn(this,(function(n){switch(n.label){case 0:return[4,this._getCredentials()];case 1:return(t=n.sent())?(Object.assign(e,{config:this._config,credentials:t}),[2,this._putToBuffer(e)]):[2,Promise.resolve(!1)]}}))}))},e.prototype.updateEndpoint=function(){return jn.debug("updateEndpoint is not implemented in Kinesis provider"),Promise.resolve(!0)},e.prototype._putToBuffer=function(e){return this._buffer.length<1e3?(this._buffer.push(e),Promise.resolve(!0)):(jn.debug("exceed analytics events buffer size"),Promise.reject(!1))},e.prototype._sendFromBuffer=function(e){for(var t=this,n=[],r=null,i=[],o=0;o<e.length;o+=1){var s=e[o].credentials;0===o?(i.push(e[o]),r=s):s.sessionToken===r.sessionToken&&s.identityId===r.identityId?(jn.debug("no change for cred, put event in the same group"),i.push(e[o])):(n.push(i),(i=[]).push(e[o]),r=s)}n.push(i),n.map((function(e){t._sendEvents(e)}))},e.prototype._sendEvents=function(e){var t=this;if(0!==e.length){var n=e[0],r=n.config,i=n.credentials;if(!this._init(r,i))return!1;var o={};e.map((function(e){var t=e.event,n=t.streamName;void 0===o[n]&&(o[n]=[]);var r=t.data&&"string"!=typeof t.data?JSON.stringify(t.data):t.data,s={Data:Object(oe.fromUtf8)(r),PartitionKey:t.partitionKey||"partition-"+i.identityId};o[n].push(s)})),Object.keys(o).map((function(e){return En(t,void 0,void 0,(function(){var t,n;return Sn(this,(function(r){switch(r.label){case 0:jn.debug("putting records to kinesis with records",o[e]),r.label=1;case 1:return r.trys.push([1,3,,4]),t=new ln({Records:o[e],StreamName:e}),[4,this._kinesis.send(t)];case 2:return r.sent(),jn.debug("Upload records to stream",e),[3,4];case 3:return n=r.sent(),jn.debug("Failed to upload records to Kinesis",n),[3,4];case 4:return[2]}}))}))}))}},e.prototype._init=function(e,t){if(jn.debug("init clients"),this._kinesis&&this._config.credentials&&this._config.credentials.sessionToken===t.sessionToken&&this._config.credentials.identityId===t.identityId)return jn.debug("no change for analytics config, directly return from init"),!0;this._config.credentials=t;var n=e.region,r=e.endpoint;return this._initKinesis(n,r,t)},e.prototype._initKinesis=function(e,t,n){return jn.debug("initialize kinesis with credentials",n),this._kinesis=new On({region:e,credentials:n,customUserAgent:Object(r.getAmplifyUserAgent)(),endpoint:t}),!0},e.prototype._getCredentials=function(){var e=this;return r.Credentials.get().then((function(t){return t?(jn.debug("set credentials for analytics",e._config.credentials),r.Credentials.shear(t)):null})).catch((function(e){return jn.debug("ensure credentials error",e),null}))},e}(),xn=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,d,l,f,p,h;return Object(i.__generator)(this,(function(v){switch(v.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,$n(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=v.sent(),o)])),a="UnknownError",u=n.body.__type.split("#"),a=void 0===u[1]?u[0]:u[1],a){case"InvalidArgumentException":case"com.amazonaws.firehose#InvalidArgumentException":return[3,2];case"InvalidKMSResourceException":case"com.amazonaws.firehose#InvalidKMSResourceException":return[3,4];case"ResourceNotFoundException":case"com.amazonaws.firehose#ResourceNotFoundException":return[3,6];case"ServiceUnavailableException":case"com.amazonaws.firehose#ServiceUnavailableException":return[3,8]}return[3,10];case 2:return c=[{}],[4,In(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,c.concat([v.sent()])),{name:a,$metadata:Hn(e)}]),[3,11];case 4:return d=[{}],[4,Pn(n,t)];case 5:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,d.concat([v.sent()])),{name:a,$metadata:Hn(e)}]),[3,11];case 6:return l=[{}],[4,Mn(n,t)];case 7:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,l.concat([v.sent()])),{name:a,$metadata:Hn(e)}]),[3,11];case 8:return f=[{}],[4,Tn(n,t)];case 9:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,f.concat([v.sent()])),{name:a,$metadata:Hn(e)}]),[3,11];case 10:p=n.body,a=p.code||p.Code||a,s=Object(i.__assign)(Object(i.__assign)({},p),{name:""+a,message:p.message||p.Message||a,$fault:"client",$metadata:Hn(e)}),v.label=11;case 11:return h=s.message||s.Message||a,s.message=h,delete s.Message,[2,Promise.reject(Object.assign(new Error(h),s))]}}))}))},In=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Un(n,t),[2,Object(i.__assign)({name:"InvalidArgumentException",$fault:"client",$metadata:Hn(e)},r)]}))}))},Pn=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Dn(n,t),[2,Object(i.__assign)({name:"InvalidKMSResourceException",$fault:"client",$metadata:Hn(e)},r)]}))}))},Mn=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=Nn(n,t),[2,Object(i.__assign)({name:"ResourceNotFoundException",$fault:"client",$metadata:Hn(e)},r)]}))}))},Tn=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(o){return n=e.body,r=qn(n,t),[2,Object(i.__assign)({name:"ServiceUnavailableException",$fault:"server",$metadata:Hn(e)},r)]}))}))},Cn=function(e,t){return Object(i.__assign)(Object(i.__assign)({},void 0!==e.DeliveryStreamName&&{DeliveryStreamName:e.DeliveryStreamName}),void 0!==e.Records&&{Records:Rn(e.Records,t)})},Rn=function(e,t){return e.map((function(e){return kn(e,t)}))},kn=function(e,t){return Object(i.__assign)({},void 0!==e.Data&&{Data:t.base64Encoder(e.Data)})},Un=function(e,t){return{__type:"InvalidArgumentException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Dn=function(e,t){return{__type:"InvalidKMSResourceException",code:void 0!==e.code&&null!==e.code?e.code:void 0,message:void 0!==e.message&&null!==e.message?e.message:void 0}},zn=function(e,t){return{__type:"PutRecordBatchOutput",Encrypted:void 0!==e.Encrypted&&null!==e.Encrypted?e.Encrypted:void 0,FailedPutCount:void 0!==e.FailedPutCount&&null!==e.FailedPutCount?e.FailedPutCount:void 0,RequestResponses:void 0!==e.RequestResponses&&null!==e.RequestResponses?Ln(e.RequestResponses,t):void 0}},Ln=function(e,t){return(e||[]).map((function(e){return function(e,t){return{__type:"PutRecordBatchResponseEntry",ErrorCode:void 0!==e.ErrorCode&&null!==e.ErrorCode?e.ErrorCode:void 0,ErrorMessage:void 0!==e.ErrorMessage&&null!==e.ErrorMessage?e.ErrorMessage:void 0,RecordId:void 0!==e.RecordId&&null!==e.RecordId?e.RecordId:void 0}}(e)}))},Nn=function(e,t){return{__type:"ResourceNotFoundException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},qn=function(e,t){return{__type:"ServiceUnavailableException",message:void 0!==e.message&&null!==e.message?e.message:void 0}},Hn=function(e){return{httpStatusCode:e.statusCode,httpHeaders:e.headers,requestId:e.headers["x-amzn-requestid"]}},Bn=function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))},Fn=function(e,t,n,r,s){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var a,u,c,d,l,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.endpoint()];case 1:return a=i.sent(),u=a.hostname,c=a.protocol,d=void 0===c?"https":c,l=a.port,f={protocol:d,hostname:u,port:l,method:"POST",path:n,headers:t},void 0!==r&&(f.hostname=r),void 0!==s&&(f.body=s),[2,new o.HttpRequest(f)]}}))}))},$n=function(e,t){return Bn(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},Vn=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){return n={"Content-Type":"application/x-amz-json-1.1","X-Amz-Target":"Firehose_20150804.PutRecordBatch"},r=JSON.stringify(Cn(e,t)),[2,Fn(t,n,"/",void 0,r)]}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o;return Object(i.__generator)(this,(function(s){switch(s.label){case 0:return e.statusCode>=400?[2,xn(e,t)]:[4,$n(e.body,t)];case 1:return n=s.sent(),{},r=zn(n,t),o=Object(i.__assign)({$metadata:Hn(e),__type:"PutRecordBatchOutput"},r),[2,Promise.resolve(o)]}}))}))}(e,t)},t}(s.Command),Kn=n(44),Wn=new Set(["ap-south-1","eu-north-1","eu-west-3","eu-west-2","eu-west-1","ap-northeast-2","ap-northeast-1","me-south-1","ca-central-1","sa-east-1","ap-east-1","ap-southeast-1","ap-southeast-2","eu-central-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Yn=new Set(["cn-north-1","cn-northwest-1"]),Gn=new Set(["us-iso-east-1"]),Jn=new Set(["us-isob-east-1"]),Zn=new Set(["us-gov-west-1","us-gov-east-1"]),Xn={apiVersion:"2015-08-04",disableHostPrefix:!1,regionInfoProvider:function(e,t){var n=void 0;switch(e){case"ap-east-1":n={hostname:"firehose.ap-east-1.amazonaws.com"};break;case"ap-northeast-1":n={hostname:"firehose.ap-northeast-1.amazonaws.com"};break;case"ap-northeast-2":n={hostname:"firehose.ap-northeast-2.amazonaws.com"};break;case"ap-south-1":n={hostname:"firehose.ap-south-1.amazonaws.com"};break;case"ap-southeast-1":n={hostname:"firehose.ap-southeast-1.amazonaws.com"};break;case"ap-southeast-2":n={hostname:"firehose.ap-southeast-2.amazonaws.com"};break;case"ca-central-1":n={hostname:"firehose.ca-central-1.amazonaws.com"};break;case"cn-north-1":n={hostname:"firehose.cn-north-1.amazonaws.com.cn"};break;case"cn-northwest-1":n={hostname:"firehose.cn-northwest-1.amazonaws.com.cn"};break;case"eu-central-1":n={hostname:"firehose.eu-central-1.amazonaws.com"};break;case"eu-north-1":n={hostname:"firehose.eu-north-1.amazonaws.com"};break;case"eu-west-1":n={hostname:"firehose.eu-west-1.amazonaws.com"};break;case"eu-west-2":n={hostname:"firehose.eu-west-2.amazonaws.com"};break;case"eu-west-3":n={hostname:"firehose.eu-west-3.amazonaws.com"};break;case"me-south-1":n={hostname:"firehose.me-south-1.amazonaws.com"};break;case"sa-east-1":n={hostname:"firehose.sa-east-1.amazonaws.com"};break;case"us-east-1":n={hostname:"firehose.us-east-1.amazonaws.com"};break;case"us-east-2":n={hostname:"firehose.us-east-2.amazonaws.com"};break;case"us-gov-east-1":n={hostname:"firehose.us-gov-east-1.amazonaws.com"};break;case"us-gov-west-1":n={hostname:"firehose.us-gov-west-1.amazonaws.com"};break;case"us-west-1":n={hostname:"firehose.us-west-1.amazonaws.com"};break;case"us-west-2":n={hostname:"firehose.us-west-2.amazonaws.com"};break;default:Wn.has(e)&&(n={hostname:"firehose.{region}.amazonaws.com".replace("{region}",e)}),Yn.has(e)&&(n={hostname:"firehose.{region}.amazonaws.com.cn".replace("{region}",e)}),Gn.has(e)&&(n={hostname:"firehose.{region}.c2s.ic.gov".replace("{region}",e)}),Jn.has(e)&&(n={hostname:"firehose.{region}.sc2s.sgov.gov".replace("{region}",e)}),Zn.has(e)&&(n={hostname:"firehose.{region}.amazonaws.com".replace("{region}",e)}),void 0===n&&(n={hostname:"firehose.{region}.amazonaws.com".replace("{region}",e)})}return Promise.resolve(n)},signingName:"firehose"},Qn=Object(i.__assign)(Object(i.__assign)({},Xn),{runtime:"browser",base64Decoder:ne.fromBase64,base64Encoder:ne.toBase64,bodyLengthChecker:re.calculateBodyLength,credentialDefaultProvider:Object(ee.invalidFunction)("Credential is missing"),defaultUserAgent:Object(ie.defaultUserAgent)(Kn.a,Kn.b),maxAttemptsDefaultProvider:function(){return"3"},regionDefaultProvider:Object(ee.invalidFunction)("Region is missing"),requestHandler:new Q.FetchHttpHandler,sha256:X.Sha256,streamCollector:Q.streamCollector,urlParser:te.parseUrl,utf8Decoder:oe.fromUtf8,utf8Encoder:oe.toUtf8}),er=function(e){function t(t){var n=this,r=Object(i.__assign)(Object(i.__assign)({},Qn),t),o=Object(pe.resolveRegionConfig)(r),s=Object(pe.resolveEndpointsConfig)(o),a=Object(ge.resolveAwsAuthConfig)(s),u=Object(_e.resolveRetryConfig)(a),c=Object(ye.resolveUserAgentConfig)(u),d=Object(ve.resolveHostHeaderConfig)(c);return(n=e.call(this,d)||this).config=d,n.middlewareStack.use(Object(ge.getAwsAuthPlugin)(n.config)),n.middlewareStack.use(Object(_e.getRetryPlugin)(n.config)),n.middlewareStack.use(Object(ye.getUserAgentPlugin)(n.config)),n.middlewareStack.use(Object(he.getContentLengthPlugin)(n.config)),n.middlewareStack.use(Object(ve.getHostHeaderPlugin)(n.config)),n}return Object(i.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(s.Client),tr=(Rt=function(e,t){return(Rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Rt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),nr=new r.ConsoleLogger("AWSKineisFirehoseProvider"),rr=function(e){function t(t){return e.call(this,t)||this}return tr(t,e),t.prototype.getProviderName=function(){return"AWSKinesisFirehose"},t.prototype._sendEvents=function(e){var t=this;if(0!==e.length){var n=e[0],r=n.config,i=n.credentials;if(!this._init(r,i))return!1;var o={};e.map((function(e){var t=e.event,n=t.streamName,r=t.data;void 0===o[n]&&(o[n]=[]);var i=r&&"string"!=typeof r?JSON.stringify(r):r,s={Data:Object(oe.fromUtf8)(i)};o[n].push(s)})),Object.keys(o).map((function(e){nr.debug("putting records to kinesis",e,"with records",o[e]),t._kinesisFirehose.send(new Vn({Records:o[e],DeliveryStreamName:e})).then((function(t){return nr.debug("Upload records to stream",e)})).catch((function(e){return nr.debug("Failed to upload records to Kinesis",e)}))}))}},t.prototype._init=function(e,t){if(nr.debug("init clients"),this._kinesisFirehose&&this._config.credentials&&this._config.credentials.sessionToken===t.sessionToken&&this._config.credentials.identityId===t.identityId)return nr.debug("no change for analytics config, directly return from init"),!0;this._config.credentials=t;var n=e.region;return this._initFirehose(n,t)},t.prototype._initFirehose=function(e,t){return nr.debug("initialize kinesis firehose with credentials",t),this._kinesisFirehose=new er({apiVersion:"2015-08-04",region:e,credentials:t}),!0},t}(An),ir=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,s,a,u,c,d;return Object(i.__generator)(this,(function(l){switch(l.label){case 0:return r=[Object(i.__assign)({},e)],o={},[4,cr(e.body,t)];case 1:switch(n=i.__assign.apply(void 0,r.concat([(o.body=l.sent(),o)])),a="UnknownError",a=dr(e,n.body),a){case"InvalidInputException":case"com.amazonaws.personalizeevents#InvalidInputException":return[3,2]}return[3,4];case 2:return u=[{}],[4,or(n,t)];case 3:return s=i.__assign.apply(void 0,[i.__assign.apply(void 0,u.concat([l.sent()])),{name:a,$metadata:ar(e)}]),[3,5];case 4:c=n.body,a=c.code||c.Code||a,s=Object(i.__assign)(Object(i.__assign)({},c),{name:""+a,message:c.message||c.Message||a,$fault:"client",$metadata:ar(e)}),l.label=5;case 5:return d=s.message||s.Message||a,s.message=d,delete s.Message,[2,Promise.reject(Object.assign(new Error(d),s))]}}))}))},or=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){return t={name:"InvalidInputException",$fault:"client",$metadata:ar(e),message:void 0},void 0!==(n=e.body).message&&null!==n.message&&(t.message=n.message),[2,t]}))}))},sr=function(e,t){return e.map((function(e){return function(e,t){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.eventId&&{eventId:e.eventId}),void 0!==e.eventType&&{eventType:e.eventType}),void 0!==e.properties&&{properties:s.LazyJsonString.fromObject(e.properties)}),void 0!==e.sentAt&&{sentAt:Math.round(e.sentAt.getTime()/1e3)})}(e)}))},ar=function(e){return{httpStatusCode:e.statusCode,httpHeaders:e.headers,requestId:e.headers["x-amzn-requestid"]}},ur=function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)},cr=function(e,t){return function(e,t){return ur(e,t).then((function(e){return t.utf8Encoder(e)}))}(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},dr=function(e,t){var n,r,i=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},o=(n=e.headers,r="x-amzn-errortype",Object.keys(n).find((function(e){return e.toLowerCase()===r.toLowerCase()})));return void 0!==o?i(e.headers[o]):void 0!==t.code?i(t.code):void 0!==t.__type?i(t.__type):""},lr=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(i.__extends)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(W.getSerdePlugin)(t,this.serialize,this.deserialize));var r=e.concat(this.middlewareStack),i=t.requestHandler;return r.resolve((function(e){return i.handle(e.request,n||{})}),{logger:{}})},t.prototype.serialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,s,a,u,c,d,l;return Object(i.__generator)(this,(function(f){switch(f.label){case 0:return n={"Content-Type":"application/json"},r="/events",s=JSON.stringify(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},void 0!==e.eventList&&{eventList:sr(e.eventList,t)}),void 0!==e.sessionId&&{sessionId:e.sessionId}),void 0!==e.trackingId&&{trackingId:e.trackingId}),void 0!==e.userId&&{userId:e.userId})),[4,t.endpoint()];case 1:return a=f.sent(),u=a.hostname,c=a.protocol,d=void 0===c?"https":c,l=a.port,[2,new o.HttpRequest({protocol:d,hostname:u,port:l,method:"POST",headers:n,path:r,body:s})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return 200!==e.statusCode&&e.statusCode>=400?[2,ir(e,t)]:(n={$metadata:ar(e)},[4,ur(e.body,t)]);case 1:return r.sent(),[2,Promise.resolve(n)]}}))}))}(e,t)},t}(s.Command),fr=n(45),pr=new Set(["ap-south-1","eu-north-1","eu-west-3","eu-west-2","eu-west-1","ap-northeast-2","ap-northeast-1","me-south-1","ca-central-1","sa-east-1","ap-east-1","ap-southeast-1","ap-southeast-2","eu-central-1","us-east-1","us-east-2","us-west-1","us-west-2"]),hr=new Set(["cn-north-1","cn-northwest-1"]),vr=new Set(["us-iso-east-1"]),_r=new Set(["us-isob-east-1"]),gr=new Set(["us-gov-west-1","us-gov-east-1"]),yr={apiVersion:"2018-03-22",disableHostPrefix:!1,regionInfoProvider:function(e,t){var n=void 0;return pr.has(e)&&(n={hostname:"personalize-events.{region}.amazonaws.com".replace("{region}",e)}),hr.has(e)&&(n={hostname:"personalize-events.{region}.amazonaws.com.cn".replace("{region}",e)}),vr.has(e)&&(n={hostname:"personalize-events.{region}.c2s.ic.gov".replace("{region}",e)}),_r.has(e)&&(n={hostname:"personalize-events.{region}.sc2s.sgov.gov".replace("{region}",e)}),gr.has(e)&&(n={hostname:"personalize-events.{region}.amazonaws.com".replace("{region}",e)}),void 0===n&&(n={hostname:"personalize-events.{region}.amazonaws.com".replace("{region}",e)}),Promise.resolve(n)},signingName:"personalize"},mr=Object(i.__assign)(Object(i.__assign)({},yr),{runtime:"browser",base64Decoder:ne.fromBase64,base64Encoder:ne.toBase64,bodyLengthChecker:re.calculateBodyLength,credentialDefaultProvider:Object(ee.invalidFunction)("Credential is missing"),defaultUserAgent:Object(ie.defaultUserAgent)(fr.a,fr.b),maxAttemptsDefaultProvider:function(){return"3"},regionDefaultProvider:Object(ee.invalidFunction)("Region is missing"),requestHandler:new Q.FetchHttpHandler,sha256:X.Sha256,streamCollector:Q.streamCollector,urlParser:te.parseUrl,utf8Decoder:oe.fromUtf8,utf8Encoder:oe.toUtf8}),br=function(e){function t(t){var n=this,r=Object(i.__assign)(Object(i.__assign)({},mr),t),o=Object(pe.resolveRegionConfig)(r),s=Object(pe.resolveEndpointsConfig)(o),a=Object(ge.resolveAwsAuthConfig)(s),u=Object(_e.resolveRetryConfig)(a),c=Object(ye.resolveUserAgentConfig)(u),d=Object(ve.resolveHostHeaderConfig)(c);return(n=e.call(this,d)||this).config=d,n.middlewareStack.use(Object(ge.getAwsAuthPlugin)(n.config)),n.middlewareStack.use(Object(_e.getRetryPlugin)(n.config)),n.middlewareStack.use(Object(ye.getUserAgentPlugin)(n.config)),n.middlewareStack.use(Object(he.getContentLengthPlugin)(n.config)),n.middlewareStack.use(Object(ve.getHostHeaderPlugin)(n.config)),n}return Object(i.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(s.Client),wr=n(5),Or=n.n(wr),Er=n(34),Sr=n.n(Er),jr=(new r.ConsoleLogger("AmazonPersonalizeProvider"),function(){function e(e){void 0===e&&(e=""),this._isBrowser=r.JS.browserOrNode().isBrowser,this._timerKey=Object(Oe.v1)().substr(0,15),this._refreshTimer()}return e.prototype._refreshTimer=function(){this._timer&&clearInterval(this._timer);var e=this;this._timer=setInterval((function(){e._timerKey=Object(Oe.v1)().substr(0,15)}),3e4)},e.prototype.storeValue=function(e,t){var n=new Date,r=new Date;r.setTime(n.getTime()+6048e5),we.a.setItem(this._getCachePrefix(e),t,{expires:r.getTime()})},e.prototype.retrieveValue=function(e){return we.a.getItem(this._getCachePrefix(e))},e.prototype._getCachePrefix=function(e){return this._isBrowser?e+"."+window.location.host:"peronslize"},e.prototype.getTimerKey=function(){return this._timerKey},e.prototype.updateSessionInfo=function(e,t){var n=t.userId,r=t.sessionId;if(this._isRequireNewSession(e,n,r)){var i=Object(Oe.v1)();this.storeValue("_awsct_uid",e),this.storeValue("_awsct_sid",i),t.sessionId=i}else this._isRequireUpdateSessionInfo(e,n,r)&&this.storeValue("_awsct_uid",e);t.userId=e},e.prototype._isRequireUpdateSessionInfo=function(e,t,n){return!Or()(n)&&Or()(t)&&!Or()(e)},e.prototype.retrieveSessionInfo=function(e){var t={};return t.trackingId=e,t.sessionId=this.retrieveValue("_awsct_sid"),t.userId=this.retrieveValue("_awsct_uid"),Or()(t.sessionId)&&(t.sessionId=Object(Oe.v1)(),this.storeValue("_awsct_sid",t.sessionId)),this.storeValue("_awsct",e),t},e.prototype._isRequireNewSession=function(e,t,n){var r=Or()(n),i=Or()(e)&&!Or()(t),o=!Or()(e)&&!Or()(t)&&!Sr()(e,t);return r||i||o},e}());!function(e){e.PLAY="play",e.PAUSE="pause",e.ENDED="Ended"}(kt||(kt={})),function(e){e.IFRAME="IFRAME",e.VIDEO="VIDEO",e.AUDIO="AUDIO"}(Ut||(Ut={})),function(e){e.PLAY="Play",e.ENDED="Ended",e.PAUSE="Pause",e.TIME_WATCHED="TimeWatched"}(Dt||(Dt={}));var Ar=function(){function e(e,t){var n;this.eventActionMapping=((n={})[Dt.ENDED]=this.endedEventAction.bind(this),n[Dt.PLAY]=this.playEventAction.bind(this),n[Dt.PAUSE]=this.pauseEventAction.bind(this),n);var r=e.eventData;this._params=e,this._mediaElement=document.getElementById(r.properties.domElementId),this._started=!1,this._provider=t,{IFRAME:this._iframeMediaTracker,VIDEO:this._html5MediaTracker,AUDIO:this._html5MediaTracker}[this._mediaElement.tagName].bind(this)(),this._initYoutubeFrame()}return e.prototype._initYoutubeFrame=function(){this._youTubeIframeLoader={src:"https://www.youtube.com/iframe_api",loading:!1,loaded:!1,listeners:[],load:function(e){var t=this;if(this.listeners.push(e),this.loaded)setTimeout((function(){t.done()}));else if(!this.loading){this.loading=!0,window.onYouTubeIframeAPIReady=function(){t.loaded=!0,t.done()};var n=document.createElement("script");n.type="text/javascript",n.src=this.src,document.body.appendChild(n)}},done:function(){for(delete window.onYouTubeIframeAPIReady;this.listeners.length;)this.listeners.pop()(window.YT)}}},e.prototype._iframeMediaTracker=function(){var e=this;setInterval((function(){e._started&&e.recordEvent(Ut.IFRAME,Dt.TIME_WATCHED)}),3e3),this._youTubeIframeLoader.load((function(t){e._iframePlayer=new t.Player(e._mediaElement.id,{events:{onStateChange:e._onPlayerStateChange.bind(e)}})}))},e.prototype._onPlayerStateChange=function(e){var t={0:Dt.ENDED,1:Dt.PLAY,2:Dt.PAUSE}[e.data];t&&this.eventActionMapping[t](Ut.IFRAME)},e.prototype._html5MediaTracker=function(){var e=this;setInterval((function(){e._started&&e.recordEvent(Ut.VIDEO,Dt.TIME_WATCHED)}),3e3),this._mediaElement.addEventListener(kt.PLAY,(function(){e.eventActionMapping[Dt.PLAY](Ut.VIDEO)}),!1),this._mediaElement.addEventListener(kt.PAUSE,(function(){e.eventActionMapping[Dt.PAUSE](Ut.VIDEO)}),!1),this._mediaElement.addEventListener(kt.ENDED,(function(){e.eventActionMapping[Dt.ENDED](Ut.VIDEO)}),!1)},e.prototype.playEventAction=function(e){this._started=!0,this.recordEvent(e,Dt.PLAY)},e.prototype.pauseEventAction=function(e){this._started=!1,this.recordEvent(e,Dt.PAUSE)},e.prototype.endedEventAction=function(e){this._started=!1,this.recordEvent(e,Dt.ENDED)},e.prototype.recordEvent=function(e,t){var n=Object.assign({},this._params),r=n.eventData;r.eventType=t,e===Ut.VIDEO?(r.properties.timestamp=this._mediaElement.currentTime,r.properties.duration=this._mediaElement.duration):(r.properties.timestamp=this._financial(this._iframePlayer.getCurrentTime()),r.properties.duration=this._financial(this._iframePlayer.getDuration()));var i=parseFloat(r.properties.timestamp)/parseFloat(r.properties.duration);r.properties.eventValue=Number(i.toFixed(4)),delete r.properties.domElementId,this._provider.putToBuffer(n)},e.prototype._financial=function(e){return Number.parseFloat(e).toFixed(4)},e}(),xr=n(84),Ir=n.n(xr),Pr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Mr=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Tr=new r.ConsoleLogger("AmazonPersonalizeProvider"),Cr=function(){function e(e){this._buffer=[],this._config=e||{},this._config.flushSize=this._config.flushSize>0&&this._config.flushSize<=10?this._config.flushSize:5,this._config.flushInterval=this._config.flushInterval||5e3,this._sessionManager=new jr,Or()(this._config.trackingId)||(this._sessionInfo=this._sessionManager.retrieveSessionInfo(this._config.trackingId)),this._isBrowser=r.JS.browserOrNode().isBrowser,this._setupTimer()}return e.prototype._setupTimer=function(){this._timer&&clearInterval(this._timer);var e=this._config.flushInterval,t=this;this._timer=setInterval((function(){t._sendFromBuffer()}),e)},e.prototype.record=function(e){return Pr(this,void 0,void 0,(function(){var t,n,r,i,o;return Mr(this,(function(s){switch(s.label){case 0:return[4,this._getCredentials()];case 1:return(t=s.sent())?(Object.assign(e,{config:this._config,credentials:t,sentAt:new Date}),n=e.event,r=n.eventType,i=n.properties,"Identify"===r?(this._sessionManager.updateSessionInfo(i&&i.userId?i.userId:"",this._sessionInfo),[2]):(Or()(e.event.userId)||this._sessionManager.updateSessionInfo(e.event.userId,this._sessionInfo),o=this.generateRequestParams(e,this._sessionInfo),"MediaAutoTrack"!==r?[3,7]:this._isBrowser?Or()(Ir()(o,"eventData.properties.domElementId",null))?[3,3]:[4,this.isElementFullyLoaded(this.loadElement,o.eventData.properties.domElementId,500,5)]:[3,5])):[2,Promise.resolve(!1)];case 2:return s.sent()?new Ar(o,this):Tr.debug("Cannot find the media element."),[3,4];case 3:Tr.debug("Missing domElementId field in 'properties' for MediaAutoTrack event type."),s.label=4;case 4:return[3,6];case 5:Tr.debug("MediaAutoTrack only for browser"),s.label=6;case 6:return[2];case 7:return[2,this.putToBuffer(o)]}}))}))},e.prototype.loadElement=function(e){return new Promise((function(t,n){return document.getElementById(e)&&document.getElementById(e).clientHeight?t(!0):n(!0)}))},e.prototype.isElementFullyLoaded=function(e,t,n,r){var i=this;return new Promise((function(o,s){return e(t).then(o).catch((function(a){return r-1>0?(u=n,new Promise((function(e){return setTimeout(e,u)}))).then(i.isElementFullyLoaded.bind(null,e,t,n,r-1)).then(o).catch(s):s(a);var u}))}))},e.prototype.getCategory=function(){return"Analytics"},e.prototype.getProviderName=function(){return"AmazonPersonalize"},e.prototype.configure=function(e){Tr.debug("configure Analytics",e);var t=e||{};return this._config=Object.assign({},this._config,t),Or()(this._config.trackingId)||(this._sessionInfo=this._sessionManager.retrieveSessionInfo(this._config.trackingId)),this._setupTimer(),this._config},e.prototype.generateRequestParams=function(e,t){var n={},r=e.event,i=r.eventType,o=r.properties;return n.eventData={eventType:i,properties:o},n.sessionInfo=t,n.sentAt=e.sentAt,n.credentials=e.credentials,n.config=e.config,n},e.prototype._sendEvents=function(e){var t=e.length;if(0!==t){var n=e[0],r=n.config,i=n.credentials,o=n.sessionInfo;if(!this._init(r,i))return!1;if(t>0){for(var s=[],a=0;a<t;a+=1){var u=e.shift(),c=this._generateSingleRecordPayload(u,o);s.push(c)}var d={};d.trackingId=o.trackingId,d.sessionId=o.sessionId,d.userId=o.userId,d.eventList=[],s.forEach((function(e){d.eventList.push(e)}));var l=new lr(d);this._personalize.send(l,(function(e){e?Tr.debug("Failed to call putEvents in Personalize",e):Tr.debug("Put events")}))}}else Tr.debug("events array is empty, directly return")},e.prototype.putToBuffer=function(e){return this._buffer.length<this._config.flushSize?this._buffer.push(e):(this._buffer.push(e),this._sendFromBuffer()),Promise.resolve(!0)},e.prototype._sendFromBuffer=function(){var e=this,t=this._buffer.length;if(!(t<=0)){for(var n=[],r=null,i=[],o=0;o<t;o+=1){var s=this._buffer.shift(),a=s.credentials,u=s.sessionInfo;0===o?(i.push(s),r=a):Sr()(u,this._sessionInfo)&&a.sessionToken===r.sessionToken&&a.identityId===r.identityId?(Tr.debug("no change for cred, put event in the same group"),i.push(s)):(n.push(i),(i=[]).push(s),r=a,this._sessionInfo=u)}n.push(i),n.map((function(t){e._sendEvents(t)}))}},e.prototype._generateSingleRecordPayload=function(e,t){var n=e.eventData,r=e.sentAt,i={};return i.sentAt=r,i.properties=n.properties&&JSON.stringify(n.properties),i.eventId=this._sessionManager.getTimerKey()+t.sessionId,i.eventType=n.eventType,i},e.prototype._init=function(e,t){if(Tr.debug("init clients"),this._personalize&&this._config.credentials&&this._config.credentials.sessionToken===t.sessionToken&&this._config.credentials.identityId===t.identityId)return Tr.debug("no change for analytics config, directly return from init"),!0;this._config.credentials=t;var n=e.region;return Tr.debug("initialize personalize with credentials",t),this._personalize=new br({region:n,credentials:t,customUserAgent:Object(r.getAmplifyUserAgent)()}),!0},e.prototype._getCredentials=function(){var e=this;return r.Credentials.get().then((function(t){return t?(Tr.debug("set credentials for analytics",e._config.credentials),r.Credentials.shear(t)):null})).catch((function(e){return Tr.debug("ensure credentials error",e),null}))},e}();t.default=Ct},function(e,t,n){"use strict";n.r(t),n.d(t,"createScope",(function(){return h})),n.d(t,"getSigningKey",(function(){return v})),n.d(t,"clearCredentialCache",(function(){return _})),n.d(t,"SignatureV4",(function(){return A}));var r=n(0),i="X-Amz-Date".toLowerCase(),o=["authorization",i,"date"],s="X-Amz-Signature".toLowerCase(),a="X-Amz-Security-Token".toLowerCase(),u={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},c=/^proxy-/,d=/^sec-/,l="AWS4-HMAC-SHA256-PAYLOAD",f={},p=[];function h(e,t,n){return e+"/"+t+"/"+n+"/aws4_request"}function v(e,t,n,i,o){var s=n+":"+i+":"+o+":"+t.accessKeyId+":"+t.sessionToken;if(s in f)return f[s];for(p.push(s);p.length>50;)delete f[p.shift()];return f[s]=new Promise((function(a,u){var c,d,l=Promise.resolve("AWS4"+t.secretAccessKey),p=function(t){(l=l.then((function(n){return r=t,(i=new e(n)).update(r),i.digest();var r,i}))).catch((function(){}))};try{for(var h=Object(r.__values)([n,i,o,"aws4_request"]),v=h.next();!v.done;v=h.next()){p(v.value)}}catch(e){c={error:e}}finally{try{v&&!v.done&&(d=h.return)&&d.call(h)}finally{if(c)throw c.error}}l.then(a,(function(e){delete f[s],u(e)}))}))}function _(){p.length=0,Object.keys(f).forEach((function(e){delete f[e]}))}var g=n(17);function y(e,t,n){var i,o,s=e.headers,a={};try{for(var l=Object(r.__values)(Object.keys(s).sort()),f=l.next();!f.done;f=l.next()){var p=f.value,h=p.toLowerCase();(h in u||(null==t?void 0:t.has(h))||c.test(h)||d.test(h))&&(!n||n&&!n.has(h))||(a[h]=s[p].trim().replace(/\s+/g," "))}}catch(e){i={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return a}var m=n(26);var b=n(81);function w(e,t){var n=e.headers,i=e.body;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,o,s,a,u,c,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:try{for(e=Object(r.__values)(Object.keys(n)),o=e.next();!o.done;o=e.next())if("x-amz-content-sha256"===(s=o.value).toLowerCase())return[2,n[s]]}catch(e){c={error:e}}finally{try{o&&!o.done&&(d=e.return)&&d.call(e)}finally{if(c)throw c.error}}return null!=i?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return"string"==typeof i||ArrayBuffer.isView(i)||Object(b.isArrayBuffer)(i)?((a=new t).update(i),u=g.toHex,[4,a.digest()]):[3,3];case 2:return[2,u.apply(void 0,[l.sent()])];case 3:return[2,"UNSIGNED-PAYLOAD"]}}))}))}function O(e){var t=e.headers,n=e.query,i=Object(r.__rest)(e,["headers","query"]);return Object(r.__assign)(Object(r.__assign)({},i),{headers:Object(r.__assign)({},t),query:n?E(n):void 0})}function E(e){return Object.keys(e).reduce((function(t,n){var i,o=e[n];return Object(r.__assign)(Object(r.__assign)({},t),((i={})[n]=Array.isArray(o)?Object(r.__spread)(o):o,i))}),{})}function S(e){var t,n;e="function"==typeof e.clone?e.clone():O(e);try{for(var i=Object(r.__values)(Object.keys(e.headers)),s=i.next();!s.done;s=i.next()){var a=s.value;o.indexOf(a.toLowerCase())>-1&&delete e.headers[a]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return e}function j(e){return function(e){if("number"==typeof e)return new Date(1e3*e);if("string"==typeof e)return Number(e)?new Date(1e3*Number(e)):new Date(e);return e}(e).toISOString().replace(/\.\d{3}Z$/,"Z")}var A=function(){function e(e){var t=e.applyChecksum,n=e.credentials,r=e.region,i=e.service,o=e.sha256,s=e.uriEscapePath,a=void 0===s||s;if(this.service=i,this.sha256=o,this.uriEscapePath=a,this.applyChecksum="boolean"!=typeof t||t,"string"==typeof r){var u=Promise.resolve(r);this.regionProvider=function(){return u}}else this.regionProvider=r;if("object"==typeof n){var c=Promise.resolve(n);this.credentialProvider=function(){return c}}else this.credentialProvider=n}return e.prototype.presign=function(e,t){return void 0===t&&(t={}),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,s,a,u,c,d,l,f,p,v,_,g,m,b,E,j,A,P,M;return Object(r.__generator)(this,(function(T){switch(T.label){case 0:return[4,Promise.all([this.regionProvider(),this.credentialProvider()])];case 1:return n=r.__read.apply(void 0,[T.sent(),2]),i=n[0],o=n[1],s=t.signingDate,a=void 0===s?new Date:s,u=t.expiresIn,c=void 0===u?3600:u,d=t.unsignableHeaders,l=t.signableHeaders,f=x(a),p=f.longDate,v=f.shortDate,c>604800?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(_=h(v,i,this.service),g=function(e){var t,n,i="function"==typeof e.clone?e.clone():O(e),o=i.headers,s=i.query,a=void 0===s?{}:s;try{for(var u=Object(r.__values)(Object.keys(o)),c=u.next();!c.done;c=u.next()){var d=c.value;"x-amz-"===d.toLowerCase().substr(0,6)&&(a[d]=o[d],delete o[d])}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return Object(r.__assign)(Object(r.__assign)({},e),{headers:o,query:a})}(S(e)),o.sessionToken&&(g.query["X-Amz-Security-Token"]=o.sessionToken),g.query["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",g.query["X-Amz-Credential"]=o.accessKeyId+"/"+_,g.query["X-Amz-Date"]=p,g.query["X-Amz-Expires"]=c.toString(10),m=y(g,d,l),g.query["X-Amz-SignedHeaders"]=I(m),b=g.query,E="X-Amz-Signature",j=this.getSignature,A=[p,_,this.getSigningKey(o,i,v)],P=this.createCanonicalRequest,M=[g,m],[4,w(e,this.sha256)]);case 2:return[4,j.apply(this,A.concat([P.apply(this,M.concat([T.sent()]))]))];case 3:return b[E]=T.sent(),[2,g]}}))}))},e.prototype.sign=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return"string"==typeof e?[2,this.signString(e,t)]:e.headers&&e.payload?[2,this.signEvent(e,t)]:[2,this.signRequest(e,t)]}))}))},e.prototype.signEvent=function(e,t){var n=e.headers,i=e.payload,o=t.signingDate,s=void 0===o?new Date:o,a=t.priorSignature;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,o,u,c,d,f,p,v,_,y;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return[4,Promise.all([this.regionProvider(),this.credentialProvider()])];case 1:return e=r.__read.apply(void 0,[m.sent(),1]),t=e[0],o=x(s),u=o.shortDate,c=o.longDate,d=h(u,t,this.service),[4,w({headers:{},body:i},this.sha256)];case 2:return f=m.sent(),(p=new this.sha256).update(n),_=g.toHex,[4,p.digest()];case 3:return v=_.apply(void 0,[m.sent()]),y=[l,c,d,a,v,f].join("\n"),[2,this.signString(y,{signingDate:s})]}}))}))},e.prototype.signString=function(e,t){var n=(void 0===t?{}:t).signingDate,i=void 0===n?new Date:n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,s,a,u,c,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Promise.all([this.regionProvider(),this.credentialProvider()])];case 1:return t=r.__read.apply(void 0,[l.sent(),2]),n=t[0],o=t[1],s=x(i).shortDate,c=(u=this.sha256).bind,[4,this.getSigningKey(o,n,s)];case 2:return(a=new(c.apply(u,[void 0,l.sent()]))).update(e),d=g.toHex,[4,a.digest()];case 3:return[2,d.apply(void 0,[l.sent()])]}}))}))},e.prototype.signRequest=function(e,t){var n=void 0===t?{}:t,o=n.signingDate,s=void 0===o?new Date:o,u=n.signableHeaders,c=n.unsignableHeaders;return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,d,l,f,p,v,_,g,m;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:return[4,Promise.all([this.regionProvider(),this.credentialProvider()])];case 1:return t=r.__read.apply(void 0,[b.sent(),2]),n=t[0],o=t[1],d=S(e),l=x(s),f=l.longDate,p=l.shortDate,v=h(p,n,this.service),d.headers[i]=f,o.sessionToken&&(d.headers[a]=o.sessionToken),[4,w(d,this.sha256)];case 2:return _=b.sent(),!function(e,t){var n,i;e=e.toLowerCase();try{for(var o=Object(r.__values)(Object.keys(t)),s=o.next();!s.done;s=o.next()){if(e===s.value.toLowerCase())return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}("x-amz-content-sha256",d.headers)&&this.applyChecksum&&(d.headers["x-amz-content-sha256"]=_),g=y(d,c,u),[4,this.getSignature(f,v,this.getSigningKey(o,n,p),this.createCanonicalRequest(d,g,_))];case 3:return m=b.sent(),d.headers.authorization="AWS4-HMAC-SHA256 Credential="+o.accessKeyId+"/"+v+", SignedHeaders="+I(g)+", Signature="+m,[2,d]}}))}))},e.prototype.createCanonicalRequest=function(e,t,n){var i=Object.keys(t).sort();return e.method+"\n"+this.getCanonicalPath(e)+"\n"+function(e){var t,n,i=e.query,o=void 0===i?{}:i,a=[],u={},c=function(e){if(e.toLowerCase()===s)return"continue";a.push(e);var t=o[e];"string"==typeof t?u[e]=Object(m.escapeUri)(e)+"="+Object(m.escapeUri)(t):Array.isArray(t)&&(u[e]=t.slice(0).sort().reduce((function(t,n){return t.concat([Object(m.escapeUri)(e)+"="+Object(m.escapeUri)(n)])}),[]).join("&"))};try{for(var d=Object(r.__values)(Object.keys(o).sort()),l=d.next();!l.done;l=d.next()){c(l.value)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return a.map((function(e){return u[e]})).filter((function(e){return e})).join("&")}(e)+"\n"+i.map((function(e){return e+":"+t[e]})).join("\n")+"\n\n"+i.join(";")+"\n"+n},e.prototype.createStringToSign=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(i=new this.sha256).update(n),[4,i.digest()];case 1:return o=r.sent(),[2,"AWS4-HMAC-SHA256\n"+e+"\n"+t+"\n"+Object(g.toHex)(o)]}}))}))},e.prototype.getCanonicalPath=function(e){var t=e.path;return this.uriEscapePath?"/"+encodeURIComponent(t.replace(/^\//,"")).replace(/%2F/g,"/"):t},e.prototype.getSignature=function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,s,a,u,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.createStringToSign(e,t,i)];case 1:return o=r.sent(),u=(a=this.sha256).bind,[4,n];case 2:return(s=new(u.apply(a,[void 0,r.sent()]))).update(o),c=g.toHex,[4,s.digest()];case 3:return[2,c.apply(void 0,[r.sent()])]}}))}))},e.prototype.getSigningKey=function(e,t,n){return v(this.sha256,e,n,t,this.service)},e}();function x(e){var t=j(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.substr(0,8)}}function I(e){return Object.keys(e).sort().join(";")}},function(e,t,n){"use strict";function r(e){return"function"==typeof TextEncoder?function(e){return(new TextEncoder).encode(e)}(e):function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192,63&i|128);else if(n+1<e.length&&55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))){var o=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n));t.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}else t.push(i>>12|224,i>>6&63|128,63&i|128)}return Uint8Array.from(t)}(e)}function i(e){return"function"==typeof TextDecoder?function(e){return new TextDecoder("utf-8").decode(e)}(e):function(e){for(var t="",n=0,r=e.length;n<r;n++){var i=e[n];if(i<128)t+=String.fromCharCode(i);else if(192<=i&&i<224){var o=e[++n];t+=String.fromCharCode((31&i)<<6|63&o)}else if(240<=i&&i<365){var s="%"+[i,e[++n],e[++n],e[++n]].map((function(e){return e.toString(16)})).join("%");t+=decodeURIComponent(s)}else t+=String.fromCharCode((15&i)<<12|(63&e[++n])<<6|63&e[++n])}return t}(e)}n.r(t),n.d(t,"fromUtf8",(function(){return r})),n.d(t,"toUtf8",(function(){return i}))}])}));
//# sourceMappingURL=aws-amplify-analytics.min.js.map